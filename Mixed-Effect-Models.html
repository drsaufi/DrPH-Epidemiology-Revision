<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dr Muhammad Saufi">
<meta name="dcterms.date" content="2024-07-16">

<title>Logistic Regression with Correlated Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Mixed-Effect-Models_files/libs/clipboard/clipboard.min.js"></script>
<script src="Mixed-Effect-Models_files/libs/quarto-html/quarto.js"></script>
<script src="Mixed-Effect-Models_files/libs/quarto-html/popper.min.js"></script>
<script src="Mixed-Effect-Models_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Mixed-Effect-Models_files/libs/quarto-html/anchor.min.js"></script>
<link href="Mixed-Effect-Models_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Mixed-Effect-Models_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="Mixed-Effect-Models_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="Mixed-Effect-Models_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Mixed-Effect-Models_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Mixed-Effect-Models_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="Mixed-Effect-Models_files/libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="Mixed-Effect-Models_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="Mixed-Effect-Models_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="Mixed-Effect-Models_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

<script src="Mixed-Effect-Models_files/libs/datatables-binding-0.33/datatables.js"></script>

<script src="Mixed-Effect-Models_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="Mixed-Effect-Models_files/libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">

<link href="Mixed-Effect-Models_files/libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">

<script src="Mixed-Effect-Models_files/libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>

<link href="Mixed-Effect-Models_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="Mixed-Effect-Models_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

<script src="Mixed-Effect-Models_files/libs/kePrint-0.0.1/kePrint.js"></script>

<link href="Mixed-Effect-Models_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="1">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a>
  <ul>
  <li><a href="#marginal-models-population-average-models" id="toc-marginal-models-population-average-models" class="nav-link" data-scroll-target="#marginal-models-population-average-models"><span class="header-section-number">1.1</span> Marginal Models (Population Average Models)</a></li>
  <li><a href="#conditional-models-random-effects-models" id="toc-conditional-models-random-effects-models" class="nav-link" data-scroll-target="#conditional-models-random-effects-models"><span class="header-section-number">1.2</span> Conditional Models (Random Effects Models)</a></li>
  </ul></li>
  <li><a href="#setting-up-the-environment" id="toc-setting-up-the-environment" class="nav-link" data-scroll-target="#setting-up-the-environment"><span class="header-section-number">2</span> Setting Up the Environment</a></li>
  <li><a href="#multilevel-random-intercept-model" id="toc-multilevel-random-intercept-model" class="nav-link" data-scroll-target="#multilevel-random-intercept-model"><span class="header-section-number">3</span> Multilevel Random Intercept Model</a>
  <ul>
  <li><a href="#dataset-overview" id="toc-dataset-overview" class="nav-link" data-scroll-target="#dataset-overview"><span class="header-section-number">3.1</span> Dataset Overview</a></li>
  <li><a href="#hierarchical-data-structure" id="toc-hierarchical-data-structure" class="nav-link" data-scroll-target="#hierarchical-data-structure"><span class="header-section-number">3.2</span> Hierarchical Data Structure</a></li>
  <li><a href="#estimation" id="toc-estimation" class="nav-link" data-scroll-target="#estimation"><span class="header-section-number">3.3</span> Estimation</a>
  <ul>
  <li><a href="#sources-of-correlation" id="toc-sources-of-correlation" class="nav-link" data-scroll-target="#sources-of-correlation"><span class="header-section-number">3.3.1</span> Sources of Correlation</a></li>
  <li><a href="#model-variables" id="toc-model-variables" class="nav-link" data-scroll-target="#model-variables"><span class="header-section-number">3.3.2</span> Model Variables</a></li>
  <li><a href="#data-transformation" id="toc-data-transformation" class="nav-link" data-scroll-target="#data-transformation"><span class="header-section-number">3.3.3</span> Data Transformation</a></li>
  <li><a href="#population-average-model" id="toc-population-average-model" class="nav-link" data-scroll-target="#population-average-model"><span class="header-section-number">3.3.4</span> Population Average Model</a></li>
  <li><a href="#conditional-clustered-specific-model" id="toc-conditional-clustered-specific-model" class="nav-link" data-scroll-target="#conditional-clustered-specific-model"><span class="header-section-number">3.3.5</span> Conditional (Clustered-Specific) Model</a>
  <ul class="collapse">
  <li><a href="#log-odds" id="toc-log-odds" class="nav-link" data-scroll-target="#log-odds"><span class="header-section-number">3.3.5.1</span> Log Odds</a></li>
  <li><a href="#odds-ratios" id="toc-odds-ratios" class="nav-link" data-scroll-target="#odds-ratios"><span class="header-section-number">3.3.5.2</span> Odds Ratios</a></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation"><span class="header-section-number">3.3.5.3</span> Interpretation</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#random-effect" id="toc-random-effect" class="nav-link" data-scroll-target="#random-effect"><span class="header-section-number">3.4</span> Random Effect</a></li>
  <li><a href="#plots" id="toc-plots" class="nav-link" data-scroll-target="#plots"><span class="header-section-number">3.5</span> Plots</a>
  <ul>
  <li><a href="#fixed-effect-plot" id="toc-fixed-effect-plot" class="nav-link" data-scroll-target="#fixed-effect-plot"><span class="header-section-number">3.5.1</span> Fixed Effect Plot</a></li>
  <li><a href="#random-effect-plot" id="toc-random-effect-plot" class="nav-link" data-scroll-target="#random-effect-plot"><span class="header-section-number">3.5.2</span> Random Effect Plot</a></li>
  </ul></li>
  <li><a href="#prediction" id="toc-prediction" class="nav-link" data-scroll-target="#prediction"><span class="header-section-number">3.6</span> Prediction</a>
  <ul>
  <li><a href="#prediction-for-subjects-level-1" id="toc-prediction-for-subjects-level-1" class="nav-link" data-scroll-target="#prediction-for-subjects-level-1"><span class="header-section-number">3.6.1</span> Prediction for Subjects (Level 1)</a></li>
  <li><a href="#prediction-for-sites-level-2" id="toc-prediction-for-sites-level-2" class="nav-link" data-scroll-target="#prediction-for-sites-level-2"><span class="header-section-number">3.6.2</span> Prediction for Sites (Level 2)</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#multilevel-random-intercept-and-random-slope-model" id="toc-multilevel-random-intercept-and-random-slope-model" class="nav-link" data-scroll-target="#multilevel-random-intercept-and-random-slope-model"><span class="header-section-number">4</span> Multilevel Random Intercept and Random Slope Model</a>
  <ul>
  <li><a href="#dataset-overview-1" id="toc-dataset-overview-1" class="nav-link" data-scroll-target="#dataset-overview-1"><span class="header-section-number">4.1</span> Dataset Overview</a></li>
  <li><a href="#estimation-1" id="toc-estimation-1" class="nav-link" data-scroll-target="#estimation-1"><span class="header-section-number">4.2</span> Estimation</a>
  <ul>
  <li><a href="#random-intercept-model" id="toc-random-intercept-model" class="nav-link" data-scroll-target="#random-intercept-model"><span class="header-section-number">4.2.1</span> Random Intercept Model</a></li>
  <li><a href="#random-slope-model" id="toc-random-slope-model" class="nav-link" data-scroll-target="#random-slope-model"><span class="header-section-number">4.2.2</span> Random Slope Model</a></li>
  <li><a href="#model-comparison" id="toc-model-comparison" class="nav-link" data-scroll-target="#model-comparison"><span class="header-section-number">4.2.3</span> Model Comparison</a></li>
  <li><a href="#interpretation-of-random-slope-model" id="toc-interpretation-of-random-slope-model" class="nav-link" data-scroll-target="#interpretation-of-random-slope-model"><span class="header-section-number">4.2.4</span> Interpretation of Random Slope Model</a></li>
  <li><a href="#random-slope-model-ii" id="toc-random-slope-model-ii" class="nav-link" data-scroll-target="#random-slope-model-ii"><span class="header-section-number">4.2.5</span> Random Slope Model II</a>
  <ul class="collapse">
  <li><a href="#predicted-log-odds-for-each-woman" id="toc-predicted-log-odds-for-each-woman" class="nav-link" data-scroll-target="#predicted-log-odds-for-each-woman"><span class="header-section-number">4.2.5.1</span> Predicted Log-Odds for Each Woman</a></li>
  <li><a href="#manual-calculation-for-predicted-log-odds" id="toc-manual-calculation-for-predicted-log-odds" class="nav-link" data-scroll-target="#manual-calculation-for-predicted-log-odds"><span class="header-section-number">4.2.5.2</span> Manual Calculation for Predicted Log-Odds</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#plots-1" id="toc-plots-1" class="nav-link" data-scroll-target="#plots-1"><span class="header-section-number">4.3</span> Plots</a>
  <ul>
  <li><a href="#fixed-effects-plot" id="toc-fixed-effects-plot" class="nav-link" data-scroll-target="#fixed-effects-plot"><span class="header-section-number">4.3.1</span> Fixed Effects Plot</a></li>
  <li><a href="#random-effect-plot-1" id="toc-random-effect-plot-1" class="nav-link" data-scroll-target="#random-effect-plot-1"><span class="header-section-number">4.3.2</span> Random Effect Plot</a></li>
  <li><a href="#plotting-the-predicted-values-and-marginal-effects" id="toc-plotting-the-predicted-values-and-marginal-effects" class="nav-link" data-scroll-target="#plotting-the-predicted-values-and-marginal-effects"><span class="header-section-number">4.3.3</span> Plotting the Predicted Values and Marginal Effects</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#longitudinal-data" id="toc-longitudinal-data" class="nav-link" data-scroll-target="#longitudinal-data"><span class="header-section-number">5</span> Longitudinal Data</a>
  <ul>
  <li><a href="#dataset-overview-2" id="toc-dataset-overview-2" class="nav-link" data-scroll-target="#dataset-overview-2"><span class="header-section-number">5.1</span> Dataset Overview</a></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis"><span class="header-section-number">5.2</span> Exploratory Data Analysis</a>
  <ul>
  <li><a href="#descriptive-analysis" id="toc-descriptive-analysis" class="nav-link" data-scroll-target="#descriptive-analysis"><span class="header-section-number">5.2.1</span> Descriptive Analysis</a></li>
  <li><a href="#data-visualization" id="toc-data-visualization" class="nav-link" data-scroll-target="#data-visualization"><span class="header-section-number">5.2.2</span> Data Visualization</a></li>
  </ul></li>
  <li><a href="#estimation-2" id="toc-estimation-2" class="nav-link" data-scroll-target="#estimation-2"><span class="header-section-number">5.3</span> Estimation</a>
  <ul>
  <li><a href="#population-average-model-1" id="toc-population-average-model-1" class="nav-link" data-scroll-target="#population-average-model-1"><span class="header-section-number">5.3.1</span> Population Average Model</a></li>
  <li><a href="#random-intercept-model-1" id="toc-random-intercept-model-1" class="nav-link" data-scroll-target="#random-intercept-model-1"><span class="header-section-number">5.3.2</span> Random Intercept Model</a></li>
  <li><a href="#interpretation-1" id="toc-interpretation-1" class="nav-link" data-scroll-target="#interpretation-1"><span class="header-section-number">5.3.3</span> Interpretation</a></li>
  <li><a href="#prediction-1" id="toc-prediction-1" class="nav-link" data-scroll-target="#prediction-1"><span class="header-section-number">5.3.4</span> Prediction</a>
  <ul class="collapse">
  <li><a href="#fixed-effects" id="toc-fixed-effects" class="nav-link" data-scroll-target="#fixed-effects"><span class="header-section-number">5.3.4.1</span> Fixed Effects</a></li>
  <li><a href="#random-effects" id="toc-random-effects" class="nav-link" data-scroll-target="#random-effects"><span class="header-section-number">5.3.4.2</span> Random Effects</a></li>
  <li><a href="#predicted-log-odds-and-probability" id="toc-predicted-log-odds-and-probability" class="nav-link" data-scroll-target="#predicted-log-odds-and-probability"><span class="header-section-number">5.3.4.3</span> Predicted Log Odds and Probability</a></li>
  <li><a href="#manual-calculation-of-log-odds" id="toc-manual-calculation-of-log-odds" class="nav-link" data-scroll-target="#manual-calculation-of-log-odds"><span class="header-section-number">5.3.4.4</span> Manual Calculation of Log Odds</a>
  <ul class="collapse">
  <li><a href="#observation-1" id="toc-observation-1" class="nav-link" data-scroll-target="#observation-1"><span class="header-section-number">5.3.4.4.1</span> Observation 1</a></li>
  <li><a href="#observation-7" id="toc-observation-7" class="nav-link" data-scroll-target="#observation-7"><span class="header-section-number">5.3.4.4.2</span> Observation 7</a></li>
  </ul></li>
  <li><a href="#predicting-new-data" id="toc-predicting-new-data" class="nav-link" data-scroll-target="#predicting-new-data"><span class="header-section-number">5.3.4.5</span> Predicting New Data</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#plots-2" id="toc-plots-2" class="nav-link" data-scroll-target="#plots-2"><span class="header-section-number">5.4</span> Plots</a>
  <ul>
  <li><a href="#fixed-effect-plot-1" id="toc-fixed-effect-plot-1" class="nav-link" data-scroll-target="#fixed-effect-plot-1"><span class="header-section-number">5.4.1</span> Fixed Effect Plot</a></li>
  <li><a href="#random-effect-plot-2" id="toc-random-effect-plot-2" class="nav-link" data-scroll-target="#random-effect-plot-2"><span class="header-section-number">5.4.2</span> Random Effect Plot</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#acknowledgment" id="toc-acknowledgment" class="nav-link" data-scroll-target="#acknowledgment"><span class="header-section-number">6</span> Acknowledgment</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">7</span> References</a></li>
  <li><a href="#r-codes" id="toc-r-codes" class="nav-link" data-scroll-target="#r-codes"><span class="header-section-number">8</span> R Codes</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Logistic Regression with Correlated Data</h1>
<p class="subtitle lead">Advanced Categorical Data Analysis</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dr Muhammad Saufi </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 16, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
About This Document
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This document serves both learning and practical purposes. It is designed for educational use, aiming to enhance statistical analysis skills and provide clear, organized notes for future reference.</p>
</div>
</div>
</div>
<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>Logistic regression for correlated data is designed to handle situations where binary outcomes (e.g., success/failure) are not independent, such as in clustered data (e.g., patients within hospitals) or repeated measures (e.g., multiple observations over time on the same subject). Standard logistic regression assumes independence among observations, which, when violated, leads to biased estimates and incorrect inferences. To address this, two primary models are used: marginal models and conditional models.</p>
<section id="marginal-models-population-average-models" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="marginal-models-population-average-models"><span class="header-section-number">1.1</span> Marginal Models (Population Average Models)</h2>
<p>Marginal models focus on estimating the average effect of covariates across the entire population. They use Generalized Estimating Equations (GEE) to account for the correlation within clusters. The GEE approach specifies a working correlation structure (e.g., independence, exchangeable, auto-regressive, unstructured) to adjust for within-cluster correlations and provides robust population-level estimates.</p>
</section>
<section id="conditional-models-random-effects-models" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="conditional-models-random-effects-models"><span class="header-section-number">1.2</span> Conditional Models (Random Effects Models)</h2>
<p>Conditional models include random effects to capture variability within clusters, offering subject-specific or cluster-specific inferences.</p>
<ul>
<li><p><strong>Random Intercept Models</strong>: Allow the intercept to vary across clusters, capturing baseline differences. Represent the average effect of covariates on the log-odds of the outcome.</p></li>
<li><p><strong>Random Slope Models</strong>: Allow both the intercept and the slope of the covariate to vary across clusters, capturing differences in the effect of covariates. Capture unobserved heterogeneity between clusters or subjects.</p></li>
</ul>
</section>
</section>
<section id="setting-up-the-environment" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Setting Up the Environment</h1>
<p>Load the necessary libraries to ensure the R environment is equipped with the tools and functions required for efficient and effective analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(aplore3)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gee)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HSAUR2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="multilevel-random-intercept-model" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Multilevel Random Intercept Model</h1>
<p>Random intercept model is used to account for hierarchical or nested data structures. This model includes both fixed effects, which apply to the entire population, and random effects, which account for the variability between clusters by allowing each cluster to have its own intercept, which captures the baseline level of the response variable for that cluster.</p>
<section id="dataset-overview" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="dataset-overview"><span class="header-section-number">3.1</span> Dataset Overview</h2>
<p>The dataset is from the book “Applied Logistic Regression” by Hosmer, Lemeshow, and Sturdivant (2013). The specific dataset referred to is called <code>GLOW_RAND</code>, which contains 500 observations. This dataset is used for demonstrating logistic regression techniques and can be loaded in R using the <code>aplore3</code> package. The dataset contains:</p>
<ul>
<li><p><strong>6 sites</strong>: The number of subjects per site varies from as few as 24 in one site (site 4) to as many as 113 in another site (site 2).</p></li>
<li><p><strong>124 physicians</strong>: The number of subjects treated by each physician varies from 1 to 13.</p></li>
<li><p><strong>Outcome of Interest</strong>: Whether a fracture occurred in the first year of follow-up (fracture), coded as <code>NO</code> (0) or <code>YES</code> (1).</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data wrangling</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data_glow <span class="ot">&lt;-</span> glow_rand</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(data_glow)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 500
Columns: 15
$ sub_id    &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 1…
$ site_id   &lt;int&gt; 2, 3, 3, 4, 5, 1, 3, 5, 5, 1, 1, 6, 2, 2, 3, 1, 1, 1, 2, 3, …
$ phy_id    &lt;int&gt; 80, 95, 184, 280, 289, 39, 114, 297, 294, 39, 28, 313, 71, 7…
$ priorfrac &lt;fct&gt; No, No, No, No, No, No, Yes, No, No, No, Yes, Yes, No, Yes, …
$ age       &lt;int&gt; 69, 66, 62, 69, 58, 86, 64, 75, 62, 80, 74, 85, 58, 66, 61, …
$ weight    &lt;dbl&gt; 72.6, 79.4, 78.5, 72.6, 48.5, 80.7, 68.0, 77.1, 49.9, 62.6, …
$ height    &lt;dbl&gt; 157.5, 162.6, 170.2, 154.9, 157.5, 154.9, 175.3, 160.0, 160.…
$ bmi       &lt;dbl&gt; 29.3, 30.0, 27.1, 30.2, 19.6, 33.6, 22.2, 30.1, 19.5, 26.1, …
$ premeno   &lt;fct&gt; No, No, No, Yes, No, No, No, Yes, No, No, No, No, No, Yes, N…
$ momfrac   &lt;fct&gt; No, No, No, No, No, Yes, No, No, No, No, No, No, No, No, No,…
$ armassist &lt;fct&gt; Yes, Yes, No, Yes, No, No, No, Yes, No, No, No, No, No, No, …
$ smoke     &lt;fct&gt; No, No, No, Yes, No, No, No, No, No, No, Yes, No, No, No, No…
$ raterisk  &lt;fct&gt; Greater, Greater, Same, Same, Greater, Same, Greater, Less, …
$ fracscore &lt;int&gt; 4, 4, 1, 4, 1, 7, 2, 6, 2, 5, 5, 7, 0, 3, 1, 7, 6, 3, 4, 7, …
$ fracture  &lt;fct&gt; No, No, No, No, No, No, No, No, No, No, No, No, No, No, No, …</code></pre>
</div>
</div>
</section>
<section id="hierarchical-data-structure" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="hierarchical-data-structure"><span class="header-section-number">3.2</span> Hierarchical Data Structure</h2>
<p>The data is structured in multiple levels to account for the correlation within clusters. Each level represents a different grouping or clustering of the data:</p>
<ul>
<li><p><strong>Level 1</strong>: Subject</p>
<ul>
<li>This is the individual level, where each <code>sub_id</code> represents a unique participant or subject in the study.</li>
<li>A participant in a clinical study with specific characteristics like age, gender, medical history, etc.</li>
</ul></li>
<li><p><strong>Level 2</strong>: Physician for Subject</p>
<ul>
<li>This level groups subjects under the same physician. Each <code>phy_id</code> represents a unique physician who is responsible for multiple subjects.</li>
<li>All subjects treated by the same doctor. This introduces correlation because subjects under the same physician might receive similar treatments or follow similar protocols.</li>
</ul></li>
<li><p><strong>Level 3</strong>: Site Where Physician Works</p>
<ul>
<li>This is the highest level, grouping physicians by the site or location where they work. Each <code>site_id</code> represents a unique site, such as a hospital or clinic.</li>
<li>All physicians working in the same hospital. This adds another layer of correlation because practices and resources can vary between sites, affecting the subjects treated there.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data structure</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>data_glow <span class="sc">%&gt;%</span> <span class="fu">count</span>(site_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  site_id   n
1       1 111
2       2 113
3       3  76
4       4  24
5       5  99
6       6  77</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>data_glow <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(site_id, phy_id) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-df5808e8b81d3c9b67fe" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-df5808e8b81d3c9b67fe">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124"],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6],[1,3,7,8,16,21,22,23,24,25,26,27,28,29,30,31,33,34,35,36,37,38,39,42,45,49,50,51,53,54,59,61,62,63,64,66,68,70,71,72,73,74,76,77,78,79,80,82,85,87,95,97,109,111,114,115,116,121,126,128,130,137,141,143,145,146,159,162,163,166,172,175,179,180,181,184,185,186,187,190,193,194,197,229,280,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,304,305,306,309,311,312,313,315,316,317,318,319,320,321,322,323,324,325],[5,3,3,1,1,3,2,10,6,2,3,6,2,3,4,7,2,7,4,11,7,4,12,3,4,1,6,1,5,5,4,5,2,8,12,3,5,4,7,6,2,2,4,5,1,7,5,1,4,4,2,1,3,5,3,1,2,3,1,2,2,1,2,2,2,4,1,3,4,6,1,1,2,2,3,3,4,3,4,2,1,4,1,1,6,6,1,5,7,9,5,6,5,2,7,2,2,13,5,9,2,4,1,4,11,3,2,4,1,5,3,4,9,3,4,7,5,7,2,4,4,2,5,8]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>site_id<\/th>\n      <th>phy_id<\/th>\n      <th>n<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"site_id","targets":1},{"name":"phy_id","targets":2},{"name":"n","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="estimation" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="estimation"><span class="header-section-number">3.3</span> Estimation</h2>
<p>In hierarchical or nested data structures, observations within the same group tend to be more similar to each other than to observations in different groups. This leads to correlation within groups, which needs to be accounted for in the analysis to avoid biased estimates and incorrect inferences.</p>
<section id="sources-of-correlation" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="sources-of-correlation"><span class="header-section-number">3.3.1</span> Sources of Correlation</h3>
<p>In this dataset, there are two possible sources of correlation:</p>
<ol type="1">
<li><p><strong>Physician (<code>phy_id</code>)</strong>: Subjects (Level 1) are grouped under the same physician (Level 2). This means that subjects treated by the same physician may have more similar outcomes compared to subjects treated by different physicians.</p></li>
<li><p><strong>Site (<code>site_id</code>)</strong>: Physicians (Level 2) are grouped under the same site (Level 3). This means that physicians working at the same site may follow similar protocols or share resources, leading to more similar outcomes for their subjects compared to physicians working at different sites.</p></li>
</ol>
<p>Because of these nested structures, we consider using random effects models to account for the correlation within these groups. However, in this analysis, the focus is on a two-level model using only the site level (<code>site_id</code>).</p>
</section>
<section id="model-variables" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="model-variables"><span class="header-section-number">3.3.2</span> Model Variables</h3>
<p>The following covariates are used:</p>
<ul>
<li><p><code>weight5</code>: Continuous variable representing the weight (kg) at enrollment, divided by 5. Dividing by 5 helps in interpreting the coefficient more easily, as it will represent the change in log-odds for a 5 kg increase in weight.</p></li>
<li><p><code>armassist</code>: Dichotomous variable indicating whether the subject needs assistance with their arms to stand.</p></li>
<li><p><code>raterisk</code>: Three-level categorical variable indicating the self-reported risk of fracture (low, medium, high).</p></li>
</ul>
</section>
<section id="data-transformation" class="level3" data-number="3.3.3">
<h3 data-number="3.3.3" class="anchored" data-anchor-id="data-transformation"><span class="header-section-number">3.3.3</span> Data Transformation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data transformation</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>data_glow2 <span class="ot">&lt;-</span> data_glow <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight5 =</span> weight <span class="sc">/</span> <span class="dv">5</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">frac2 =</span> <span class="fu">as.integer</span>(fracture) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the transformed data</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dfSummary</span>(data_glow2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data Frame Summary  
data_glow2  
Dimensions: 500 x 17  
Duplicates: 0  

--------------------------------------------------------------------------------------------------------------
No   Variable    Stats / Values              Freqs (% of Valid)    Graph                  Valid      Missing  
---- ----------- --------------------------- --------------------- ---------------------- ---------- ---------
1    sub_id      Mean (sd) : 250.5 (144.5)   500 distinct values   : : : : : : : : : :    500        0        
     [integer]   min &lt; med &lt; max:            (Integer sequence)    : : : : : : : : : :    (100.0%)   (0.0%)   
                 1 &lt; 250.5 &lt; 500                                   : : : : : : : : : :                        
                 IQR (CV) : 249.5 (0.6)                            : : : : : : : : : :                        
                                                                   : : : : : : : : : :                        

2    site_id     Mean (sd) : 3.2 (1.8)       1 : 111 (22.2%)       IIII                   500        0        
     [integer]   min &lt; med &lt; max:            2 : 113 (22.6%)       IIII                   (100.0%)   (0.0%)   
                 1 &lt; 3 &lt; 6                   3 :  76 (15.2%)       III                                        
                 IQR (CV) : 3 (0.6)          4 :  24 ( 4.8%)                                                  
                                             5 :  99 (19.8%)       III                                        
                                             6 :  77 (15.4%)       III                                        

3    phy_id      Mean (sd) : 163.9 (117.8)   124 distinct values   : .                    500        0        
     [integer]   min &lt; med &lt; max:                                  : :       : :          (100.0%)   (0.0%)   
                 1 &lt; 139 &lt; 325                                     : :       : :                              
                 IQR (CV) : 241 (0.7)                              : : . :   : :                              
                                                                   : : : :   : :                              

4    priorfrac   1. No                       359 (71.8%)           IIIIIIIIIIIIII         500        0        
     [factor]    2. Yes                      141 (28.2%)           IIIII                  (100.0%)   (0.0%)   

5    age         Mean (sd) : 68.6 (8.7)      36 distinct values    : . :                  500        0        
     [integer]   min &lt; med &lt; max:                                  : : : .                (100.0%)   (0.0%)   
                 55 &lt; 67 &lt; 90                                      : : : : :                                  
                 IQR (CV) : 14 (0.1)                               : : : : : :                                
                                                                   : : : : : : :                              

6    weight      Mean (sd) : 71.8 (15.1)     120 distinct values       : :                500        0        
     [numeric]   min &lt; med &lt; max:                                      : : :              (100.0%)   (0.0%)   
                 38.1 &lt; 70.3 &lt; 129.3                                 . : : :                                  
                 IQR (CV) : 19 (0.2)                                 : : : : :                                
                                                                     : : : : : . . .                          

7    height      Mean (sd) : 161.9 (6.3)     17 distinct values          :   :            500        0        
     [numeric]   min &lt; med &lt; max:                                        :   :            (100.0%)   (0.0%)   
                 142.2 &lt; 162.6 &lt; 182.9                                 . : : :                                
                 IQR (CV) : 7.6 (0)                                    : : : : .                              
                                                                     . : : : : : .                            

8    bmi         Mean (sd) : 27.4 (5.4)      178 distinct values     . :                  500        0        
     [numeric]   min &lt; med &lt; max:                                    : :                  (100.0%)   (0.0%)   
                 15.4 &lt; 26.6 &lt; 48.1                                  : : .                                    
                 IQR (CV) : 7.2 (0.2)                                : : :                                    
                                                                   . : : : : .                                

9    premeno     1. No                       409 (81.8%)           IIIIIIIIIIIIIIII       500        0        
     [factor]    2. Yes                       91 (18.2%)           III                    (100.0%)   (0.0%)   

10   momfrac     1. No                       432 (86.4%)           IIIIIIIIIIIIIIIII      500        0        
     [factor]    2. Yes                       68 (13.6%)           II                     (100.0%)   (0.0%)   

11   armassist   1. No                       309 (61.8%)           IIIIIIIIIIII           500        0        
     [factor]    2. Yes                      191 (38.2%)           IIIIIII                (100.0%)   (0.0%)   

12   smoke       1. No                       469 (93.8%)           IIIIIIIIIIIIIIIIII     500        0        
     [factor]    2. Yes                       31 ( 6.2%)           I                      (100.0%)   (0.0%)   

13   raterisk    1. Less                     137 (27.4%)           IIIII                  500        0        
     [factor]    2. Same                     210 (42.0%)           IIIIIIII               (100.0%)   (0.0%)   
                 3. Greater                  153 (30.6%)           IIIIII                                     

14   fracscore   Mean (sd) : 3.6 (2.5)       11 distinct values    :                      500        0        
     [integer]   min &lt; med &lt; max:                                  : .   .                (100.0%)   (0.0%)   
                 0 &lt; 3 &lt; 10                                        : : : :                                    
                 IQR (CV) : 3 (0.7)                                : : : : : . . .                            
                                                                   : : : : : : : : .                          

15   fracture    1. No                       375 (75.0%)           IIIIIIIIIIIIIII        500        0        
     [factor]    2. Yes                      125 (25.0%)           IIIII                  (100.0%)   (0.0%)   

16   weight5     Mean (sd) : 14.4 (3)        120 distinct values       : :                500        0        
     [numeric]   min &lt; med &lt; max:                                      : : :              (100.0%)   (0.0%)   
                 7.6 &lt; 14.1 &lt; 25.9                                   . : : :                                  
                 IQR (CV) : 3.8 (0.2)                                : : : : :                                
                                                                     : : : : : . . .                          

17   frac2       Min  : 0                    0 : 375 (75.0%)       IIIIIIIIIIIIIII        500        0        
     [numeric]   Mean : 0.2                  1 : 125 (25.0%)       IIIII                  (100.0%)   (0.0%)   
                 Max  : 1                                                                                     
--------------------------------------------------------------------------------------------------------------</code></pre>
</div>
</div>
<hr>
<ol type="1">
<li><p>A new variable <code>weight5</code> is created by dividing the original weight by 5. For example, if the original weight is 70 kg, <code>weight5</code> will be 70/5 = 14. This transformation is done so that the coefficient for <code>weight5</code> in the logistic regression model represents the change in log-odds for a 5 kg increase in weight, making interpretation easier.</p></li>
<li><p>The <code>fracture</code> variable is originally coded as <code>NO</code> and <code>YES</code>. This step converts it into a numeric format where <code>NO</code> becomes 0 and <code>YES</code> becomes 1. The <code>as.integer()</code> function converts <code>NO</code> to 1 and <code>YES</code> to 2, so subtracting 1 results in <code>NO</code> becoming 0 and <code>YES</code> becoming 1.</p></li>
</ol>
</section>
<section id="population-average-model" class="level3" data-number="3.3.4">
<h3 data-number="3.3.4" class="anchored" data-anchor-id="population-average-model"><span class="header-section-number">3.3.4</span> Population Average Model</h3>
<p>Population Average Model is used to estimate the average effect of predictors on the outcome across the entire population. This approach is implemented using Generalized Estimating Equations (GEE).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the GEE model</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>glow_gee <span class="ot">&lt;-</span> <span class="fu">gee</span>(frac2 <span class="sc">~</span> weight5 <span class="sc">+</span> raterisk <span class="sc">+</span> armassist,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> site_id, <span class="at">data =</span> data_glow2,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), <span class="at">corstr =</span> <span class="st">"independence"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">scale.fix =</span> <span class="cn">TRUE</span>, <span class="at">scale.value =</span> <span class="dv">1</span>, <span class="at">maxiter =</span> <span class="dv">100</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    (Intercept)         weight5    rateriskSame rateriskGreater    armassistYes 
     -0.3424651      -0.1211036       0.7208085       0.7713922       0.9012544 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View the GEE model</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>glow_gee</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Logit 
 Variance to Mean Relation: Binomial 
 Correlation Structure:     Independent 

Call:
gee(formula = frac2 ~ weight5 + raterisk + armassist, id = site_id, 
    data = data_glow2, maxiter = 100, family = binomial(link = "logit"), 
    corstr = "independence", scale.fix = TRUE, scale.value = 1)

Number of observations :  500 

Maximum cluster size   :  4 


Coefficients:
    (Intercept)         weight5    rateriskSame rateriskGreater    armassistYes 
     -0.3424651      -0.1211036       0.7208085       0.7713922       0.9012544 

Estimated Scale Parameter:  1
Number of Iterations:  1

Working Correlation[1:4,1:4]
     [,1] [,2] [,3] [,4]
[1,]    1    0    0    0
[2,]    0    0    0    0
[3,]    0    0    0    0
[4,]    0    0    0    0


Returned Error Value:
[1] 0</code></pre>
</div>
</div>
<hr>
<p><strong>Summary of Output</strong></p>
<ol type="1">
<li><p><strong>Model Formula</strong>: <code>frac2 ~ weight5 + raterisk + armassist</code> specifies the dependent variable (<code>frac2</code>) and the independent variables (<code>weight5</code>, <code>raterisk</code>, and <code>armassist</code>).</p>
<ul>
<li><strong>ID</strong>: <code>site_id</code> indicates that clustering is by site.</li>
<li><strong>Data</strong>: <code>data_glow2</code> is the dataset used.</li>
<li><strong>Max Iterations</strong>: The maximum number of iterations for the algorithm is set to 100.</li>
<li><strong>Family</strong>: <code>binomial(link = "logit")</code> indicates a logistic regression model.</li>
<li><strong>Correlation Structure</strong>: <code>independence</code> specifies an independent correlation structure.</li>
<li><strong>Scale</strong>: The scale parameter is fixed at 1.</li>
</ul></li>
<li><p><strong>Interpretation</strong></p>
<ul>
<li><strong>Intercept</strong>: The baseline log-odds of having a fracture when all predictors are at their reference levels is -0.342.</li>
<li><strong>weight5</strong>: A 5 kg increase in weight is associated with a decrease in the log-odds of having a fracture by 0.121.</li>
<li><strong>rateriskSame</strong>: Compared to low risk, the same risk increases the log-odds of having a fracture by 0.721.</li>
<li><strong>rateriskGreater</strong>: Compared to low risk, greater risk increases the log-odds of having a fracture by 0.771.</li>
<li><strong>armassistYes</strong>: Needing arm assistance increases the log-odds of having a fracture by 0.901.</li>
</ul></li>
</ol>
<p>Proceed with the calculation of log odds and odds ratios from the model coefficients. <code>coef()</code> function extracts the estimated coefficients (log odds) from the GEE model <code>glow_gee</code>, and <code>exp()</code> function exponentiates the coefficients to convert them from log odds to odds ratios.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>res_glow_gee <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">log_odds =</span> <span class="fu">coef</span>(glow_gee),</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">odds_ratio =</span> <span class="fu">exp</span>(<span class="fu">coef</span>(glow_gee))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>res_glow_gee</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  log_odds odds_ratio
(Intercept)     -0.3424651  0.7100179
weight5         -0.1211036  0.8859421
rateriskSame     0.7208085  2.0560948
rateriskGreater  0.7713922  2.1627751
armassistYes     0.9012544  2.4626903</code></pre>
</div>
</div>
<hr>
<p><strong>Summary of Output</strong></p>
<ol type="1">
<li><p><strong>Intercept</strong>:</p>
<ul>
<li><strong>Log Odds</strong>: -0.3424651, <strong>Odds Ratio</strong>: 0.7100179</li>
<li>The odds ratio of the baseline category (when all predictors are at their reference levels) is 0.71, indicating that the odds of having a fracture are 29% lower compared to the reference category.</li>
</ul></li>
<li><p><strong>weight5</strong>:</p>
<ul>
<li><strong>Log Odds</strong>: -0.1211036, <strong>Odds Ratio</strong>: 0.8859421</li>
<li>For each 5 kg increase in weight, the odds of having a fracture decrease by 11.4% (odds ratio of 0.886).</li>
</ul></li>
<li><p><strong>rateriskSame</strong>:</p>
<ul>
<li><strong>Log Odds</strong>: 0.7208085, <strong>Odds Ratio</strong>: 2.0560948</li>
<li>Compared to the reference category (low risk), the odds of having a fracture are approximately 2.06 times higher for those with the same risk.</li>
</ul></li>
<li><p><strong>rateriskGreater</strong>:</p>
<ul>
<li><strong>Log Odds</strong>: 0.7713922, <strong>Odds Ratio</strong>: 2.1627751</li>
<li>Compared to the reference category (low risk), the odds of having a fracture are approximately 2.16 times higher for those with a greater risk.</li>
</ul></li>
<li><p><strong>armassistYes</strong>:</p>
<ul>
<li><strong>Log Odds</strong>: 0.9012544, <strong>Odds Ratio</strong>: 2.4626903</li>
<li>The odds of having a fracture are approximately 2.46 times higher for those who need assistance with their arms to stand compared to those who do not.</li>
</ul></li>
</ol>
</section>
<section id="conditional-clustered-specific-model" class="level3" data-number="3.3.5">
<h3 data-number="3.3.5" class="anchored" data-anchor-id="conditional-clustered-specific-model"><span class="header-section-number">3.3.5</span> Conditional (Clustered-Specific) Model</h3>
<p>The conditional model, also known as the clustered-specific model, takes into account the correlation within clusters (e.g., subjects within the same site). There are two common models in this context:</p>
<ol type="1">
<li><strong>Random intercept model</strong>: Allows the intercept to vary across clusters.</li>
<li><strong>Random slope model</strong>: Allows the slope (effect of predictors) to vary across clusters.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Running the Random Intercept Model</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>glow_lme <span class="ot">&lt;-</span> <span class="fu">glmer</span>(fracture <span class="sc">~</span> weight5 <span class="sc">+</span> raterisk <span class="sc">+</span> armassist <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> site_id),</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> binomial,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">nAGQ =</span> <span class="dv">20</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_glow2</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glow_lme)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Adaptive
  Gauss-Hermite Quadrature, nAGQ = 20) [glmerMod]
 Family: binomial  ( logit )
Formula: fracture ~ weight5 + raterisk + armassist + (1 | site_id)
   Data: data_glow2

     AIC      BIC   logLik deviance df.resid 
   534.9    560.2   -261.4    522.9      494 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-1.1986 -0.5891 -0.4360  0.0838  4.0973 

Random effects:
 Groups  Name        Variance Std.Dev.
 site_id (Intercept) 0.1531   0.3913  
Number of obs: 500, groups:  site_id, 6

Fixed effects:
                Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)     -0.47129    0.64236  -0.734  0.46314    
weight5         -0.11580    0.04057  -2.854  0.00431 ** 
rateriskSame     0.68311    0.29696   2.300  0.02143 *  
rateriskGreater  0.74525    0.31284   2.382  0.01721 *  
armassistYes     0.92266    0.22795   4.048 5.17e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) weght5 rtrskS rtrskG
weight5     -0.870                     
rateriskSam -0.321 -0.001              
raterskGrtr -0.464  0.183  0.667       
armassistYs  0.092 -0.273 -0.013 -0.075</code></pre>
</div>
</div>
<hr>
<ul>
<li><p><strong>Formula</strong>: <code>fracture ~ weight5 + raterisk + armassist + (1 | site_id)</code></p>
<ul>
<li><code>fracture</code>: Dependent variable.</li>
<li><code>weight5</code>, <code>raterisk</code>, <code>armassist</code>: Independent variables (predictors).</li>
<li><code>(1 | site_id)</code>: Random intercept for each site.</li>
</ul></li>
<li><p><strong>family = binomial</strong>: Indicates logistic regression.</p></li>
<li><p><strong>nAGQ = 20</strong>: Number of points for adaptive Gauss-Hermite quadrature, used to improve the accuracy of the estimation.</p></li>
<li><p><strong>data = data_glow</strong>: Specifies the dataset.</p></li>
</ul>
<section id="log-odds" class="level4" data-number="3.3.5.1">
<h4 data-number="3.3.5.1" class="anchored" data-anchor-id="log-odds"><span class="header-section-number">3.3.5.1</span> Log Odds</h4>
<p>The <code>broom</code> package is useful for converting model objects into tidy data frames, which are easier to work with.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using `tidy` for a Tidy Output</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(glow_lme, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
  effect   group  term  estimate std.error statistic  p.value conf.low conf.high
  &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 fixed    &lt;NA&gt;   (Int…   -0.471    0.642     -0.734  4.63e-1   -1.73     0.788 
2 fixed    &lt;NA&gt;   weig…   -0.116    0.0406    -2.85   4.31e-3   -0.195   -0.0363
3 fixed    &lt;NA&gt;   rate…    0.683    0.297      2.30   2.14e-2    0.101    1.27  
4 fixed    &lt;NA&gt;   rate…    0.745    0.313      2.38   1.72e-2    0.132    1.36  
5 fixed    &lt;NA&gt;   arma…    0.923    0.228      4.05   5.17e-5    0.476    1.37  
6 ran_pars site_… sd__…    0.391   NA         NA     NA         NA       NA     </code></pre>
</div>
</div>
</section>
<section id="odds-ratios" class="level4" data-number="3.3.5.2">
<h4 data-number="3.3.5.2" class="anchored" data-anchor-id="odds-ratios"><span class="header-section-number">3.3.5.2</span> Odds Ratios</h4>
<p>To get the odds ratios, exponentiate the log odds (coefficients).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>res_glow_lme <span class="ot">&lt;-</span> <span class="fu">tidy</span>(glow_lme, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>res_glow_lme <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">effect</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">group</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.6241976</td>
<td style="text-align: right;">0.4009606</td>
<td style="text-align: right;">-0.7336806</td>
<td style="text-align: right;">0.4631434</td>
<td style="text-align: right;">0.1772323</td>
<td style="text-align: right;">2.1983729</td>
</tr>
<tr class="even">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">weight5</td>
<td style="text-align: right;">0.8906527</td>
<td style="text-align: right;">0.0361334</td>
<td style="text-align: right;">-2.8543695</td>
<td style="text-align: right;">0.0043122</td>
<td style="text-align: right;">0.8225750</td>
<td style="text-align: right;">0.9643647</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">rateriskSame</td>
<td style="text-align: right;">1.9800318</td>
<td style="text-align: right;">0.5879852</td>
<td style="text-align: right;">2.3003730</td>
<td style="text-align: right;">0.0214271</td>
<td style="text-align: right;">1.1063729</td>
<td style="text-align: right;">3.5435845</td>
</tr>
<tr class="even">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">rateriskGreater</td>
<td style="text-align: right;">2.1069703</td>
<td style="text-align: right;">0.6591381</td>
<td style="text-align: right;">2.3822348</td>
<td style="text-align: right;">0.0172079</td>
<td style="text-align: right;">1.1412246</td>
<td style="text-align: right;">3.8899650</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">armassistYes</td>
<td style="text-align: right;">2.5159854</td>
<td style="text-align: right;">0.5735138</td>
<td style="text-align: right;">4.0476976</td>
<td style="text-align: right;">0.0000517</td>
<td style="text-align: right;">1.6094535</td>
<td style="text-align: right;">3.9331254</td>
</tr>
<tr class="even">
<td style="text-align: left;">ran_pars</td>
<td style="text-align: left;">site_id</td>
<td style="text-align: left;">sd__(Intercept)</td>
<td style="text-align: right;">0.3913015</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>


</div>
</div>
<hr>
<p><strong>Summary of Output</strong></p>
<ol type="1">
<li><p>Model Fit Statistics</p>
<ul>
<li><strong>AIC</strong>: 534.9, <strong>BIC</strong>: 560.2</li>
<li>Lower AIC and BIC values generally indicate a better-fitting model.</li>
</ul></li>
<li><p>Scaled Residuals: These values indicate the distribution of the residuals (differences between observed and predicted values). Ideally, these should be symmetrically distributed around zero.</p></li>
<li><p>Random Effects: The random intercept for each site captures the variability in the baseline log-odds of fractures across different sites.</p>
<ul>
<li><strong>Groups</strong>: Random effects are grouped by <code>site_id</code>.</li>
<li><strong>Intercept Variance</strong>: 0.1531</li>
<li><strong>Intercept Std. Dev.</strong>: 0.3913</li>
<li><strong>Number of Observations</strong>: 500</li>
<li><strong>Number of Groups (sites)</strong>: 6</li>
</ul></li>
<li><p>Fixed Effects</p>
<ul>
<li><p><strong>(Intercept)</strong>: The baseline log-odds and odds ratio represent the likelihood of having a fracture when all predictors are at their reference levels. This effect is not statistically significant.</p></li>
<li><p><strong>weight5</strong>: For each 5 kg increase in weight, the log-odds of having a fracture decrease by 0.1158, and the odds decrease by about 10.9% (odds ratio = 0.891). This effect is statistically significant, indicating that higher weight reduces the likelihood of fractures.</p></li>
<li><p><strong>rateriskSame</strong>: Compared to the reference category (low risk), having the same risk increases the log-odds of having a fracture by 0.6831, and the odds increase by about 98% (odds ratio = 1.98). This effect is statistically significant, indicating that subjects who perceive themselves at the same risk are more likely to experience fractures compared to those at low risk.</p></li>
<li><p><strong>rateriskGreater</strong>: Compared to the reference category (low risk), having a greater risk increases the log-odds of having a fracture by 0.7453, and the odds increase by about 111% (odds ratio = 2.11). This effect is statistically significant, indicating that subjects who perceive themselves at greater risk are more likely to experience fractures compared to those at low risk.</p></li>
<li><p><strong>armassistYes</strong>: Needing assistance with arms to stand increases the log-odds of having a fracture by 0.9227, and the odds increase by about 152% (odds ratio = 2.52). This effect is highly statistically significant, indicating that subjects who need arm assistance to stand are significantly more likely to experience fractures compared to those who do not need assistance.</p></li>
</ul></li>
<li><p>Correlation of Fixed Effects</p>
<ul>
<li>Correlation matrix shows the correlation between the fixed effects.</li>
<li>For example, <code>weight5</code> is highly negatively correlated with the intercept (-0.870), meaning that higher weights are associated with lower baseline log-odds of fractures.</li>
</ul></li>
<li><p>Conclusion: The model fits the data well, as indicated by the AIC and BIC values. There is variability in the baseline log-odds of fractures across different sites. These results indicate that weight, risk assessment, and arm assistance significantly influence the likelihood of fractures, with some variation between different sites.</p></li>
</ol>
</section>
<section id="interpretation" class="level4" data-number="3.3.5.3">
<h4 data-number="3.3.5.3" class="anchored" data-anchor-id="interpretation"><span class="header-section-number">3.3.5.3</span> Interpretation</h4>
<ol type="1">
<li><p>The odds of a fracture in the first year computed from the proportion of subjects requiring arm assistance to stand is 2.52 times that based on the proportion of subjects not requiring arm assistance, holding self-reported risk of fracture and weight constant.</p></li>
<li><p>The population average odds ratio for a 5 kg increase in weight is 0.89. The interpretation is that the odds of a fracture in the first year computed from the proportion of subjects weighing 5 kg more than some reference weight is about 11% lower than that based on the reference weight, holding self-reported risk and arm assistance constant.</p></li>
<li><p>The interpretation is that the odds of fracture in the first year of follow-up computed from the proportion of subjects reporting the same risk as others in the same age group is 1.98 times the odds of fracture in the first year of follow-up based on the proportion of subjects who report lower risk than others in the same age group, holding weight and arm assistance required constant.</p></li>
<li><p>The interpretation is that the odds of fracture in the first year of follow-up computed from the proportion of subjects reporting higher risk than others in the same age group is 2.11 times the odds of fracture in the first year of follow-up based on the proportion of subjects who report lower risk than others in the same age group, holding weight and arm assistance required constant.</p></li>
</ol>
</section>
</section>
</section>
<section id="random-effect" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="random-effect"><span class="header-section-number">3.4</span> Random Effect</h2>
<p>Random effect refers to the variability in the intercepts for different sites. There are six sites, so there are six random intercepts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting Random Effects</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>re_glow_lme <span class="ot">&lt;-</span> <span class="fu">tidy</span>(glow_lme, <span class="at">effects =</span> <span class="st">"ran_vals"</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>re_glow_lme</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
  effect   group   level term        estimate std.error conf.low conf.high
  &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 ran_vals site_id 1     (Intercept)  -0.0927     0.202   -0.488    0.303 
2 ran_vals site_id 2     (Intercept)  -0.0355     0.197   -0.422    0.351 
3 ran_vals site_id 3     (Intercept)  -0.460      0.254   -0.958    0.0387
4 ran_vals site_id 4     (Intercept)  -0.164      0.311   -0.774    0.446 
5 ran_vals site_id 5     (Intercept)   0.496      0.193    0.118    0.873 
6 ran_vals site_id 6     (Intercept)   0.300      0.214   -0.119    0.720 </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Each row corresponds to a site and shows the random intercept for that site along with the standard error and confidence intervals.</p>
</div>
</div>
<p>The sum of the random effect and the constant (overall intercept, which is -0.471) is the predicted intercept value for each site.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating Site-Specific Intercepts</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>re_glow_lme <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">overall_intercept =</span> <span class="sc">-</span><span class="fl">0.471</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">site_intercept =</span> estimate <span class="sc">+</span> overall_intercept</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">effect</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">group</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">level</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">overall_intercept</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">site_intercept</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ran_vals</td>
<td style="text-align: left;">site_id</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.0926875</td>
<td style="text-align: right;">0.2017820</td>
<td style="text-align: right;">-0.4881729</td>
<td style="text-align: right;">0.3027980</td>
<td style="text-align: right;">-0.471</td>
<td style="text-align: right;">-0.5636875</td>
</tr>
<tr class="even">
<td style="text-align: left;">ran_vals</td>
<td style="text-align: left;">site_id</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.0355124</td>
<td style="text-align: right;">0.1969530</td>
<td style="text-align: right;">-0.4215331</td>
<td style="text-align: right;">0.3505084</td>
<td style="text-align: right;">-0.471</td>
<td style="text-align: right;">-0.5065124</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ran_vals</td>
<td style="text-align: left;">site_id</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.4595176</td>
<td style="text-align: right;">0.2541846</td>
<td style="text-align: right;">-0.9577103</td>
<td style="text-align: right;">0.0386751</td>
<td style="text-align: right;">-0.471</td>
<td style="text-align: right;">-0.9305176</td>
</tr>
<tr class="even">
<td style="text-align: left;">ran_vals</td>
<td style="text-align: left;">site_id</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.1641113</td>
<td style="text-align: right;">0.3113168</td>
<td style="text-align: right;">-0.7742811</td>
<td style="text-align: right;">0.4460584</td>
<td style="text-align: right;">-0.471</td>
<td style="text-align: right;">-0.6351113</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ran_vals</td>
<td style="text-align: left;">site_id</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.4956664</td>
<td style="text-align: right;">0.1926745</td>
<td style="text-align: right;">0.1180313</td>
<td style="text-align: right;">0.8733015</td>
<td style="text-align: right;">-0.471</td>
<td style="text-align: right;">0.0246664</td>
</tr>
<tr class="even">
<td style="text-align: left;">ran_vals</td>
<td style="text-align: left;">site_id</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.3004812</td>
<td style="text-align: right;">0.2142455</td>
<td style="text-align: right;">-0.1194322</td>
<td style="text-align: right;">0.7203946</td>
<td style="text-align: right;">-0.471</td>
<td style="text-align: right;">-0.1705188</td>
</tr>
</tbody>
</table>


</div>
</div>
<hr>
<ul>
<li><strong>Site 1</strong>: Combined intercept is -0.564</li>
<li><strong>Site 2</strong>: Combined intercept is -0.507</li>
<li><strong>Site 3</strong>: Combined intercept is -0.931</li>
<li><strong>Site 4</strong>: Combined intercept is -0.635</li>
<li><strong>Site 5</strong>: Combined intercept is 0.026</li>
<li><strong>Site 6</strong>: Combined intercept is -0.171</li>
</ul>
<hr>
<p><strong>Interpretation</strong>:</p>
<ol type="1">
<li><p><strong>Random Intercepts</strong>: Each site’s intercept deviates from the overall intercept (-0.471) due to the random effects. This accounts for site-specific variability.</p></li>
<li><p><strong>Combined Intercepts</strong>: The combined intercepts are the sum of the overall intercept and the site-specific random intercepts. These represent the predicted log-odds of fractures for each site when all predictors are at their reference levels.</p></li>
</ol>
</section>
<section id="plots" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="plots"><span class="header-section-number">3.5</span> Plots</h2>
<p><code>sjPlot</code> package is used to create visualizations to illustrate the effects of predictors (fixed effects) and the variability across groups (random effects).</p>
<section id="fixed-effect-plot" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="fixed-effect-plot"><span class="header-section-number">3.5.1</span> Fixed Effect Plot</h3>
<p>The fixed effects plot provides a visual representation of the odds ratios for each predictor in the model, showing their effects on the outcome (fracture). Predictors with confidence intervals that do not cross 1 are statistically significant.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(glow_lme, <span class="at">type =</span> <span class="st">"est"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Mixed-Effect-Models_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="random-effect-plot" class="level3" data-number="3.5.2">
<h3 data-number="3.5.2" class="anchored" data-anchor-id="random-effect-plot"><span class="header-section-number">3.5.2</span> Random Effect Plot</h3>
<p>The random effects plot provides a visual representation of the random intercepts for each site, showing how each site’s intercept deviates from the overall intercept. Sites with significant deviations have confidence intervals that do not cross 1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(glow_lme, <span class="at">type =</span> <span class="st">"re"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Mixed-Effect-Models_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="prediction" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="prediction"><span class="header-section-number">3.6</span> Prediction</h2>
<p>Prediction is made using the fitted mixed-effects logistic regression model. It is divided into predictions for individual subjects (level 1) and sites (level 2).</p>
<section id="prediction-for-subjects-level-1" class="level3" data-number="3.6.1">
<h3 data-number="3.6.1" class="anchored" data-anchor-id="prediction-for-subjects-level-1"><span class="header-section-number">3.6.1</span> Prediction for Subjects (Level 1)</h3>
<p>The objective here is to predict the logit (log-odds) and probabilities for individual subjects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">augment</span>(glow_lme) <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">fracture</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">weight5</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">raterisk</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">armassist</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">site_id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">.fitted</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">.resid</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">.hat</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">.cooksd</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">.fixed</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">.mu</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">.offset</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">.sqrtXwt</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">.sqrtrwt</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">.weights</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">.wtres</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">.eta</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">14.52</td>
<td style="text-align: left;">Greater</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-0.5203110</td>
<td style="text-align: right;">-0.9658749</td>
<td style="text-align: right;">0.0727590</td>
<td style="text-align: right;">0.0100592</td>
<td style="text-align: right;">-0.4847986</td>
<td style="text-align: right;">0.3727795</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.4835442</td>
<td style="text-align: right;">2.068064</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.7709317</td>
<td style="text-align: right;">-0.5203110</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
<td style="text-align: right;">15.88</td>
<td style="text-align: left;">Greater</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-1.1018052</td>
<td style="text-align: right;">-0.7574758</td>
<td style="text-align: right;">0.1132251</td>
<td style="text-align: right;">0.0095684</td>
<td style="text-align: right;">-0.6422876</td>
<td style="text-align: right;">0.2494018</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.4326668</td>
<td style="text-align: right;">2.311247</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.5764293</td>
<td style="text-align: right;">-1.1018052</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">15.70</td>
<td style="text-align: left;">Same</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-2.0657637</td>
<td style="text-align: right;">-0.4884917</td>
<td style="text-align: right;">0.1016000</td>
<td style="text-align: right;">0.0031903</td>
<td style="text-align: right;">-1.6062461</td>
<td style="text-align: right;">0.1124692</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.3159429</td>
<td style="text-align: right;">3.165129</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.3559796</td>
<td style="text-align: right;">-2.0657637</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
<td style="text-align: right;">14.52</td>
<td style="text-align: left;">Same</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">-0.7110481</td>
<td style="text-align: right;">-0.8939057</td>
<td style="text-align: right;">0.1448165</td>
<td style="text-align: right;">0.0194502</td>
<td style="text-align: right;">-0.5469368</td>
<td style="text-align: right;">0.3293673</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.4699835</td>
<td style="text-align: right;">2.127734</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.7008061</td>
<td style="text-align: right;">-0.7110481</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">9.70</td>
<td style="text-align: left;">Greater</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">-0.3536375</td>
<td style="text-align: right;">-1.0313875</td>
<td style="text-align: right;">0.0797360</td>
<td style="text-align: right;">0.0132214</td>
<td style="text-align: right;">-0.8493039</td>
<td style="text-align: right;">0.4125006</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.4922843</td>
<td style="text-align: right;">2.031346</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.8379317</td>
<td style="text-align: right;">-0.3536375</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
<td style="text-align: right;">16.14</td>
<td style="text-align: left;">Same</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1.7498859</td>
<td style="text-align: right;">-0.5661114</td>
<td style="text-align: right;">0.0779562</td>
<td style="text-align: right;">0.0031872</td>
<td style="text-align: right;">-1.6571984</td>
<td style="text-align: right;">0.1480616</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.3551610</td>
<td style="text-align: right;">2.815624</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.4168858</td>
<td style="text-align: right;">-1.7498859</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">13.60</td>
<td style="text-align: left;">Greater</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-1.7604441</td>
<td style="text-align: right;">-0.5633556</td>
<td style="text-align: right;">0.1084902</td>
<td style="text-align: right;">0.0046948</td>
<td style="text-align: right;">-1.3009265</td>
<td style="text-align: right;">0.1467347</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.3538413</td>
<td style="text-align: right;">2.826126</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.4146908</td>
<td style="text-align: right;">-1.7604441</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
<td style="text-align: right;">15.42</td>
<td style="text-align: left;">Less</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">-0.8386039</td>
<td style="text-align: right;">-0.8476923</td>
<td style="text-align: right;">0.1075657</td>
<td style="text-align: right;">0.0116775</td>
<td style="text-align: right;">-1.3342703</td>
<td style="text-align: right;">0.3018289</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.4590514</td>
<td style="text-align: right;">2.178405</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.6575056</td>
<td style="text-align: right;">-0.8386039</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">9.98</td>
<td style="text-align: left;">Greater</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">-0.3860616</td>
<td style="text-align: right;">-1.0184618</td>
<td style="text-align: right;">0.0776445</td>
<td style="text-align: right;">0.0124074</td>
<td style="text-align: right;">-0.8817281</td>
<td style="text-align: right;">0.4046657</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.4908272</td>
<td style="text-align: right;">2.037377</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.8244566</td>
<td style="text-align: right;">-0.3860616</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
<td style="text-align: right;">12.52</td>
<td style="text-align: left;">Same</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1.3306874</td>
<td style="text-align: right;">-0.6848577</td>
<td style="text-align: right;">0.0724236</td>
<td style="text-align: right;">0.0044494</td>
<td style="text-align: right;">-1.2379999</td>
<td style="text-align: right;">0.2090457</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.4066271</td>
<td style="text-align: right;">2.459256</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.5140968</td>
<td style="text-align: right;">-1.3306874</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">10.70</td>
<td style="text-align: left;">Greater</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1.0577920</td>
<td style="text-align: right;">-0.7720679</td>
<td style="text-align: right;">0.0788519</td>
<td style="text-align: right;">0.0064534</td>
<td style="text-align: right;">-0.9651046</td>
<td style="text-align: right;">0.2577316</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.4373855</td>
<td style="text-align: right;">2.286313</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.5892551</td>
<td style="text-align: right;">-1.0577920</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
<td style="text-align: right;">14.52</td>
<td style="text-align: left;">Same</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">-1.1691201</td>
<td style="text-align: right;">-0.7355483</td>
<td style="text-align: right;">0.0768072</td>
<td style="text-align: right;">0.0055989</td>
<td style="text-align: right;">-1.4696013</td>
<td style="text-align: right;">0.2370141</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.4252510</td>
<td style="text-align: right;">2.351552</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.5573510</td>
<td style="text-align: right;">-1.1691201</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">11.98</td>
<td style="text-align: left;">Same</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-1.2109799</td>
<td style="text-align: right;">-0.7221518</td>
<td style="text-align: right;">0.0740723</td>
<td style="text-align: right;">0.0051477</td>
<td style="text-align: right;">-1.1754676</td>
<td style="text-align: right;">0.2295277</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.4205291</td>
<td style="text-align: right;">2.377957</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.5458069</td>
<td style="text-align: right;">-1.2109799</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
<td style="text-align: right;">14.96</td>
<td style="text-align: left;">Same</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-1.5560660</td>
<td style="text-align: right;">-0.6187359</td>
<td style="text-align: right;">0.0728332</td>
<td style="text-align: right;">0.0035748</td>
<td style="text-align: right;">-1.5205536</td>
<td style="text-align: right;">0.1742119</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.3792916</td>
<td style="text-align: right;">2.636494</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.4593086</td>
<td style="text-align: right;">-1.5560660</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">13.60</td>
<td style="text-align: left;">Less</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-2.5056952</td>
<td style="text-align: right;">-0.3961284</td>
<td style="text-align: right;">0.1264995</td>
<td style="text-align: right;">0.0027063</td>
<td style="text-align: right;">-2.0461776</td>
<td style="text-align: right;">0.0754599</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.2641320</td>
<td style="text-align: right;">3.785986</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.2856901</td>
<td style="text-align: right;">-2.5056952</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
<td style="text-align: right;">13.24</td>
<td style="text-align: left;">Greater</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.4292612</td>
<td style="text-align: right;">-1.0013741</td>
<td style="text-align: right;">0.0758334</td>
<td style="text-align: right;">0.0115602</td>
<td style="text-align: right;">-0.3365738</td>
<td style="text-align: right;">0.3943028</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.4887004</td>
<td style="text-align: right;">2.046243</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.8068394</td>
<td style="text-align: right;">-0.4292612</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">16.32</td>
<td style="text-align: left;">Same</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1.7707300</td>
<td style="text-align: right;">-0.5606819</td>
<td style="text-align: right;">0.0793516</td>
<td style="text-align: right;">0.0031870</td>
<td style="text-align: right;">-1.6780425</td>
<td style="text-align: right;">0.1454516</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.3525555</td>
<td style="text-align: right;">2.836432</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.4125636</td>
<td style="text-align: right;">-1.7707300</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
<td style="text-align: right;">17.70</td>
<td style="text-align: left;">Same</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1.0078704</td>
<td style="text-align: right;">-0.7888613</td>
<td style="text-align: right;">0.0809273</td>
<td style="text-align: right;">0.0069938</td>
<td style="text-align: right;">-0.9151829</td>
<td style="text-align: right;">0.2673968</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.4426011</td>
<td style="text-align: right;">2.259371</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.6041485</td>
<td style="text-align: right;">-1.0078704</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">12.70</td>
<td style="text-align: left;">Same</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-1.2943564</td>
<td style="text-align: right;">-0.6960169</td>
<td style="text-align: right;">0.0711077</td>
<td style="text-align: right;">0.0045174</td>
<td style="text-align: right;">-1.2588440</td>
<td style="text-align: right;">0.2151164</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.4109030</td>
<td style="text-align: right;">2.433664</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.5235210</td>
<td style="text-align: right;">-1.2943564</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
<td style="text-align: right;">16.78</td>
<td style="text-align: left;">Same</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-1.2681639</td>
<td style="text-align: right;">-0.7041483</td>
<td style="text-align: right;">0.1023228</td>
<td style="text-align: right;">0.0071451</td>
<td style="text-align: right;">-0.8086463</td>
<td style="text-align: right;">0.2195717</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.4139565</td>
<td style="text-align: right;">2.415713</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.5304222</td>
<td style="text-align: right;">-1.2681639</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">14.16</td>
<td style="text-align: left;">Greater</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1.4584624</td>
<td style="text-align: right;">-0.6467157</td>
<td style="text-align: right;">0.0786301</td>
<td style="text-align: right;">0.0043087</td>
<td style="text-align: right;">-1.3657749</td>
<td style="text-align: right;">0.1887026</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.3912722</td>
<td style="text-align: right;">2.555766</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.4822796</td>
<td style="text-align: right;">-1.4584624</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
<td style="text-align: right;">14.96</td>
<td style="text-align: left;">Less</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-1.3165143</td>
<td style="text-align: right;">-0.6891945</td>
<td style="text-align: right;">0.1014551</td>
<td style="text-align: right;">0.0067370</td>
<td style="text-align: right;">-1.2810020</td>
<td style="text-align: right;">0.2113988</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.4083006</td>
<td style="text-align: right;">2.449176</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.5177529</td>
<td style="text-align: right;">-1.3165143</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">15.52</td>
<td style="text-align: left;">Same</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1.6780894</td>
<td style="text-align: right;">-0.5851529</td>
<td style="text-align: right;">0.0739620</td>
<td style="text-align: right;">0.0032210</td>
<td style="text-align: right;">-1.5854020</td>
<td style="text-align: right;">0.1573486</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.3641291</td>
<td style="text-align: right;">2.746278</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.4321231</td>
<td style="text-align: right;">-1.6780894</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
<td style="text-align: right;">12.16</td>
<td style="text-align: left;">Same</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1.2889992</td>
<td style="text-align: right;">-0.6976742</td>
<td style="text-align: right;">0.0742203</td>
<td style="text-align: right;">0.0047723</td>
<td style="text-align: right;">-1.1963117</td>
<td style="text-align: right;">0.2160223</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.4115296</td>
<td style="text-align: right;">2.429959</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.5249252</td>
<td style="text-align: right;">-1.2889992</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">11.88</td>
<td style="text-align: left;">Less</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-1.8825128</td>
<td style="text-align: right;">-0.5323145</td>
<td style="text-align: right;">0.1065555</td>
<td style="text-align: right;">0.0040636</td>
<td style="text-align: right;">-1.8470004</td>
<td style="text-align: right;">0.1321005</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.3386000</td>
<td style="text-align: right;">2.953337</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.3901374</td>
<td style="text-align: right;">-1.8825128</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
<td style="text-align: right;">12.34</td>
<td style="text-align: left;">Greater</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">-1.3191290</td>
<td style="text-align: right;">-0.6883929</td>
<td style="text-align: right;">0.1396389</td>
<td style="text-align: right;">0.0100875</td>
<td style="text-align: right;">-1.1550177</td>
<td style="text-align: right;">0.2109632</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.4079923</td>
<td style="text-align: right;">2.451026</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.5170765</td>
<td style="text-align: right;">-1.3191290</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">12.70</td>
<td style="text-align: left;">Less</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1.1119799</td>
<td style="text-align: right;">-0.7541311</td>
<td style="text-align: right;">0.1209023</td>
<td style="text-align: right;">0.0102911</td>
<td style="text-align: right;">-1.0192924</td>
<td style="text-align: right;">0.2475020</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.4315608</td>
<td style="text-align: right;">2.317171</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.5735042</td>
<td style="text-align: right;">-1.1119799</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
<td style="text-align: right;">11.62</td>
<td style="text-align: left;">Greater</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1.1643287</td>
<td style="text-align: right;">-0.7370935</td>
<td style="text-align: right;">0.0749653</td>
<td style="text-align: right;">0.0054691</td>
<td style="text-align: right;">-1.0716412</td>
<td style="text-align: right;">0.2378816</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.4257863</td>
<td style="text-align: right;">2.348596</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.5586879</td>
<td style="text-align: right;">-1.1643287</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">11.52</td>
<td style="text-align: left;">Greater</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-1.0955735</td>
<td style="text-align: right;">-0.7595296</td>
<td style="text-align: right;">0.0761071</td>
<td style="text-align: right;">0.0059623</td>
<td style="text-align: right;">-1.0600611</td>
<td style="text-align: right;">0.2505702</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.4333414</td>
<td style="text-align: right;">2.307649</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.5782282</td>
<td style="text-align: right;">-1.0955735</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
<td style="text-align: right;">15.88</td>
<td style="text-align: left;">Same</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-0.7399381</td>
<td style="text-align: right;">-0.8833008</td>
<td style="text-align: right;">0.0687600</td>
<td style="text-align: right;">0.0075664</td>
<td style="text-align: right;">-0.7044257</td>
<td style="text-align: right;">0.3230177</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.4676294</td>
<td style="text-align: right;">2.138445</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.6907557</td>
<td style="text-align: right;">-0.7399381</td>
</tr>
</tbody>
</table>


</div>
</div>
<hr>
<ul>
<li><strong>augment(glow_lme)</strong>: This function from the <code>broom</code> package is used to add predictions and other model-related values to the original dataset.</li>
<li><strong>slice(1:30)</strong>: Selects the first 30 rows of the augmented data to display.</li>
<li><strong>kbl() %&gt;% kable_styling()</strong>: Formats the data into a nice table for better visualization.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted Probabilities for Subjects</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">predict</span>(glow_lme, <span class="at">type =</span> <span class="st">"response"</span>), <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2         3         4         5         6         7         8 
0.3727795 0.2494018 0.1124692 0.3293673 0.4125006 0.1480616 0.1467347 0.3018289 
        9        10 
0.4046657 0.2090457 </code></pre>
</div>
</div>
<hr>
<ul>
<li><strong>predict(glow_lme, type = ‘response’)</strong>: Generates predicted probabilities for the response variable (fracture) based on the fitted model. The <code>type = 'response'</code> argument specifies that the output should be in the form of probabilities.</li>
<li><strong>head(, 10)</strong>: Displays the first 10 predicted probabilities.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted Logits for Subjects</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">predict</span>(glow_lme, <span class="at">type =</span> <span class="st">"link"</span>), <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         1          2          3          4          5          6          7 
-0.5203110 -1.1018052 -2.0657637 -0.7110481 -0.3536375 -1.7498859 -1.7604441 
         8          9         10 
-0.8386039 -0.3860616 -1.3306874 </code></pre>
</div>
</div>
<hr>
<ul>
<li><strong>predict(glow_lme, type = ‘link’)</strong>: Generates predicted log-odds (logits) for the response variable (fracture) based on the fitted model. The <code>type = 'link'</code> argument specifies that the output should be in the form of log-odds.</li>
<li><strong>head(, 10)</strong>: Displays the first 10 predicted log-odds.</li>
</ul>
<p>Manually calculate the predicted probability for the first subject using the logit value using the formula used is the logistic function: <span class="math display">\[
\text{Probability} = \frac{e^{\text{logit}}}{1 + e^{\text{logit}}}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5203110</span>) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5203110</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3727795</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Result
</div>
</div>
<div class="callout-body-container callout-body">
<p>0.3727795, which is the predicted probability for the first subject.</p>
</div>
</div>
</section>
<section id="prediction-for-sites-level-2" class="level3" data-number="3.6.2">
<h3 data-number="3.6.2" class="anchored" data-anchor-id="prediction-for-sites-level-2"><span class="header-section-number">3.6.2</span> Prediction for Sites (Level 2)</h3>
<p>Predict probabilities and logits for 6 different sites (clusters).</p>
<ol type="1">
<li><strong>Create a New Data Frame</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">site_id =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>),</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">armassist =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>),</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">raterisk =</span> <span class="fu">c</span>(<span class="st">"Less"</span>, <span class="st">"Same"</span>, <span class="st">"Greater"</span>),</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight5 =</span> <span class="fu">mean</span>(data_glow2<span class="sc">$</span>weight5)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<ul>
<li><strong>expand.grid()</strong>: Creates a new data frame with all combinations of the specified levels for <code>site_id</code>, <code>armassist</code>, <code>raterisk</code>, and <code>weight5</code>.</li>
<li><strong>site_id = c(1:6)</strong>: Includes 6 sites.</li>
<li><strong>armassist = c(‘Yes’, ‘No’)</strong>: Includes both levels of arm assistance.</li>
<li><strong>raterisk = c(‘Less’, ‘Same’, ‘Greater’)</strong>: Includes all levels of self-reported risk.</li>
<li><strong>weight5 = mean(data_glow$weight5)</strong>: Sets <code>weight5</code> to the mean value of the original dataset.</li>
</ul>
<ol start="2" type="1">
<li><strong>Calculate Predicted Probabilities and Log Odds</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>prob_site <span class="ot">&lt;-</span> <span class="fu">head</span>(<span class="fu">predict</span>(glow_lme, <span class="at">newdata =</span> new_data, <span class="at">type =</span> <span class="st">"response"</span>))</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>logodds_site <span class="ot">&lt;-</span> <span class="fu">head</span>(<span class="fu">predict</span>(glow_lme, <span class="at">newdata =</span> new_data, <span class="at">type =</span> <span class="st">"link"</span>))</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="fu">head</span>(new_data), logodds_site, prob_site)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  site_id armassist raterisk  weight5 logodds_site prob_site
1       1       Yes     Less 14.35728   -1.3038941 0.2135104
2       2       Yes     Less 14.35728   -1.2467190 0.2232686
3       3       Yes     Less 14.35728   -1.6707242 0.1583276
4       4       Yes     Less 14.35728   -1.3753179 0.2017620
5       5       Yes     Less 14.35728   -0.7155402 0.3283758
6       6       Yes     Less 14.35728   -0.9107254 0.2868514</code></pre>
</div>
</div>
<hr>
<ul>
<li><strong>predict(glow_lme, newdata = new_data, type = ‘response’)</strong>: Predicts probabilities for the new data.</li>
<li><strong>predict(glow_lme, newdata = new_data, type = ‘link’)</strong>: Predicts log-odds for the new data.</li>
<li><strong>cbind(…)</strong>: Combines the new data with the predicted log-odds and probabilities for display.</li>
</ul>
<ol start="3" type="1">
<li><strong>Further Predictions and Adding to Data Frame</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>prob_site2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(glow_lme, <span class="at">newdata =</span> new_data, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>new_data<span class="sc">$</span>prob <span class="ot">&lt;-</span> prob_site2</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>new_data<span class="sc">$</span>prob</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.21351038 0.22326862 0.15832765 0.20176202 0.32837582 0.28685142
 [7] 0.09739074 0.10253375 0.06956513 0.09129019 0.16270950 0.13783493
[13] 0.34960381 0.36271350 0.27138415 0.33354274 0.49189389 0.44334127
[19] 0.17603493 0.18448215 0.12894987 0.16591364 0.27786198 0.24043849
[25] 0.36386149 0.37719576 0.28384401 0.34749537 0.50742717 0.45872554
[31] 0.18523000 0.19401457 0.13609170 0.17469212 0.29050067 0.25196890</code></pre>
</div>
</div>
<hr>
<ul>
<li><strong>predict(glow_lme, newdata = new_data, type = ‘response’)</strong>: Generates predicted probabilities for the new data.</li>
<li><strong>new_data$prob &lt;- prob_site2</strong>: Adds the predicted probabilities to the new data frame as a new column.</li>
</ul>
</section>
</section>
</section>
<section id="multilevel-random-intercept-and-random-slope-model" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Multilevel Random Intercept and Random Slope Model</h1>
<p>This type of model allows for more flexibility by letting both the intercept and the slope of one or more predictors vary across clusters (different sites). In a multilevel model, random intercepts are included to account for variability in the baseline outcome across clusters and random slopes to allow the effect of predictors to vary across clusters.</p>
<ul>
<li><strong>Random Intercept</strong>: Allows the baseline log-odds of the outcome (fracture) to vary across different sites.</li>
<li><strong>Random Slope</strong>: Allows the effect of a predictor (e.g., weight5) to vary across different sites.</li>
</ul>
<section id="dataset-overview-1" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="dataset-overview-1"><span class="header-section-number">4.1</span> Dataset Overview</h2>
<p>The data to be analyzed comes from the Bangladesh Demographic and Health Survey (BDHS), a nationally representative cross-sectional survey of women of reproductive age (13-49 years). This survey collects extensive information on health and demographic indicators, which helps in understanding the health behaviors and outcomes of women in Bangladesh.</p>
<p>The primary focus of the analysis is a binary indicator that shows whether a woman received antenatal care from a medically-trained provider (such as a doctor, nurse, or midwife) at least once before her most recent live birth. The response variable is:</p>
<ul>
<li><strong>antemed</strong>: 1 if the woman received antenatal care at least once, 0 if not.</li>
</ul>
<p>The dataset includes several predictor variables that may influence whether a woman received antenatal care. These variables are:</p>
<ol type="1">
<li><strong>comm</strong>: Community identifier.</li>
<li><strong>womid</strong>: Woman identifier.</li>
<li><strong>antemed</strong>: Received antenatal care at least once from a medically-trained provider (1 = yes, 0 = no).</li>
<li><strong>bord</strong>: Birth order of the child (ranges from 1 to 13).</li>
<li><strong>mage</strong>: Mother’s age at the child’s birth (in years).</li>
<li><strong>urban</strong>: Type of region of residence at the survey (1 = urban, 0 = rural).</li>
<li><strong>meduc</strong>: Mother’s level of education at the survey (1 = none, 2 = primary, 3 = secondary or higher).</li>
<li><strong>islam</strong>: Mother’s religion (1 = Islam, 0 = other).</li>
<li><strong>wealth</strong>: Household wealth index in quintiles (1 = poorest to 5 = richest).</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read dataset</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>antenatal <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Datasets/7.5.txt"</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(antenatal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5,366
Columns: 18
$ comm    &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2,…
$ womid   &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,…
$ antemed &lt;dbl&gt; 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 1,…
$ bord    &lt;dbl&gt; 4, 2, 3, 6, 6, 4, 2, 3, 1, 1, 1, 1, 7, 2, 1, 3, 4, 5, 7, 1, 4,…
$ mage    &lt;dbl&gt; 33, 21, 26, 28, 37, 29, 20, 29, 19, 19, 23, 15, 27, 24, 19, 20…
$ urban   &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ meduc   &lt;dbl&gt; 2, 3, 2, 1, 2, 2, 3, 3, 3, 3, 3, 3, 1, 2, 3, 3, 2, 1, 2, 3, 2,…
$ islam   &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
$ wealth  &lt;dbl&gt; 3, 4, 2, 2, 4, 4, 2, 3, 3, 4, 3, 3, 1, 2, 4, 3, 4, 3, 4, 4, 4,…
$ magec   &lt;dbl&gt; 9.3656360, -2.6343650, 2.3656350, 4.3656350, 13.3656400, 5.365…
$ magecsq &lt;dbl&gt; 87.7151300, 6.9398770, 5.5962310, 19.0587700, 178.6402000, 28.…
$ meduc2  &lt;dbl&gt; 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1,…
$ meduc3  &lt;dbl&gt; 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 1, 0,…
$ wealth2 &lt;dbl&gt; 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,…
$ wealth3 &lt;dbl&gt; 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0,…
$ wealth4 &lt;dbl&gt; 0, 1, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1,…
$ wealth5 &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ wealthc &lt;dbl&gt; -0.0081998, 0.9918002, -1.0082000, -1.0082000, 0.9918002, 0.99…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">descr</span>(antenatal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Descriptive Statistics  
antenatal  
N: 5366  

                    antemed      bord      comm     islam      mage          magec   magecsq
----------------- --------- --------- --------- --------- --------- -------------- ---------
             Mean      0.51      2.87    214.34      0.91     23.63           0.00     39.27
          Std.Dev      0.50      1.95    161.87      0.29      6.27           6.27     58.27
              Min      0.00      1.00      1.00      0.00     13.00         -10.63      0.13
               Q1      0.00      1.00     82.00      1.00     19.00          -4.63      5.60
           Median      1.00      2.00    176.00      1.00     23.00          -0.63     21.48
               Q3      1.00      4.00    328.00      1.00     28.00           4.37     54.25
              Max      1.00     13.00    550.00      1.00     49.00          25.37    643.42
              MAD      0.00      1.48    170.50      0.00      5.93           5.93     28.23
              IQR      1.00      3.00    246.00      0.00      9.00           9.00     48.66
               CV      0.97      0.68      0.76      0.32      0.27   260690684.64      1.48
         Skewness     -0.05      1.42      0.69     -2.86      0.76           0.76      3.51
      SE.Skewness      0.03      0.03      0.03      0.03      0.03           0.03      0.03
         Kurtosis     -2.00      2.24     -0.68      6.16      0.20           0.20     16.77
          N.Valid   5366.00   5366.00   5366.00   5366.00   5366.00        5366.00   5366.00
        Pct.Valid    100.00    100.00    100.00    100.00    100.00         100.00    100.00

Table: Table continues below

 

                      meduc    meduc2    meduc3     urban    wealth   wealth2   wealth3   wealth4
----------------- --------- --------- --------- --------- --------- --------- --------- ---------
             Mean      2.00      0.31      0.34      0.31      3.01      0.19      0.18      0.18
          Std.Dev      0.83      0.46      0.48      0.46      1.46      0.39      0.39      0.39
              Min      1.00      0.00      0.00      0.00      1.00      0.00      0.00      0.00
               Q1      1.00      0.00      0.00      0.00      2.00      0.00      0.00      0.00
           Median      2.00      0.00      0.00      0.00      3.00      0.00      0.00      0.00
               Q3      3.00      1.00      1.00      1.00      4.00      0.00      0.00      0.00
              Max      3.00      1.00      1.00      1.00      5.00      1.00      1.00      1.00
              MAD      1.48      0.00      0.00      0.00      1.48      0.00      0.00      0.00
              IQR      2.00      1.00      1.00      1.00      2.00      0.00      0.00      0.00
               CV      0.42      1.50      1.38      1.48      0.49      2.07      2.10      2.10
         Skewness      0.01      0.84      0.65      0.80      0.00      1.58      1.63      1.63
      SE.Skewness      0.03      0.03      0.03      0.03      0.03      0.03      0.03      0.03
         Kurtosis     -1.56     -1.30     -1.57     -1.36     -1.38      0.51      0.65      0.65
          N.Valid   5366.00   5366.00   5366.00   5366.00   5366.00   5366.00   5366.00   5366.00
        Pct.Valid    100.00    100.00    100.00    100.00    100.00    100.00    100.00    100.00

Table: Table continues below

 

                    wealth5       wealthc     womid
----------------- --------- ------------- ---------
             Mean      0.22          0.00   2683.50
          Std.Dev      0.42          1.46   1549.18
              Min      0.00         -2.01      1.00
               Q1      0.00         -1.01   1342.00
           Median      0.00         -0.01   2683.50
               Q3      0.00          0.99   4025.00
              Max      1.00          1.99   5366.00
              MAD      0.00          1.48   1988.91
              IQR      0.00          2.00   2682.50
               CV      1.86   -9762910.97      0.58
         Skewness      1.32          0.00      0.00
      SE.Skewness      0.03          0.03      0.03
         Kurtosis     -0.25         -1.38     -1.20
          N.Valid   5366.00       5366.00   5366.00
        Pct.Valid    100.00        100.00    100.00</code></pre>
</div>
</div>
</section>
<section id="estimation-1" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="estimation-1"><span class="header-section-number">4.2</span> Estimation</h2>
<p>Mixed-effects logistic regression models are fitted to estimate the effects of various predictors on whether women received antenatal care, considering the hierarchical structure of the data (women nested within communities). There are two types of models: a random intercept model and a random slope model.</p>
<section id="random-intercept-model" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="random-intercept-model"><span class="header-section-number">4.2.1</span> Random Intercept Model</h3>
<p>Random intercept model estimates the effect of predictors on the likelihood of receiving antenatal care while allowing the baseline log-odds to vary across communities.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>ri_mod <span class="ot">&lt;-</span> <span class="fu">glmer</span>(</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  antemed <span class="sc">~</span> magec <span class="sc">+</span> magecsq <span class="sc">+</span> meduc2 <span class="sc">+</span> meduc3 <span class="sc">+</span> wealthc <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> comm),</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> antenatal,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="st">"logit"</span>),</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmerControl</span>(<span class="at">calc.derivs =</span> <span class="cn">FALSE</span>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ri_mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: antemed ~ magec + magecsq + meduc2 + meduc3 + wealthc + (1 |  
    comm)
   Data: antenatal
Control: glmerControl(calc.derivs = FALSE)

     AIC      BIC   logLik deviance df.resid 
  5993.3   6039.4  -2989.7   5979.3     5359 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.5037 -0.6443  0.2568  0.6514  3.7578 

Random effects:
 Groups Name        Variance Std.Dev.
 comm   (Intercept) 0.863    0.929   
Number of obs: 5366, groups:  comm, 361

Fixed effects:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -0.4559070  0.0826099  -5.519 3.41e-08 ***
magec       -0.0002799  0.0065337  -0.043    0.966    
magecsq     -0.0010140  0.0006808  -1.489    0.136    
meduc2       0.5501056  0.0843274   6.523 6.87e-11 ***
meduc3       1.3148245  0.0974009  13.499  &lt; 2e-16 ***
wealthc      0.3994231  0.0294778  13.550  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
        (Intr) magec  magcsq meduc2 meduc3
magec   -0.024                            
magecsq -0.277 -0.489                     
meduc2  -0.542  0.208 -0.048              
meduc3  -0.543  0.311 -0.072  0.549       
wealthc  0.176 -0.123  0.071 -0.167 -0.360</code></pre>
</div>
</div>
<hr>
<ul>
<li><strong>glmer()</strong>: Fits a generalized linear mixed-effects model.</li>
<li><strong>antemed ~ magec + magecsq + meduc2 + meduc3 + wealthc</strong>: Specifies the fixed effects (predictors).</li>
<li><strong>(1 | comm)</strong>: Specifies a random intercept for the community (<code>comm</code>).</li>
<li><strong>data = antenatal</strong>: Specifies the dataset.</li>
<li><strong>family = binomial(“logit”)</strong>: Specifies that the outcome is binary and the link function is logit.</li>
<li><strong>glmerControl(calc.derivs = FALSE)</strong>: Disables derivative calculations to avoid warnings and speed up estimation.</li>
</ul>
</section>
<section id="random-slope-model" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="random-slope-model"><span class="header-section-number">4.2.2</span> Random Slope Model</h3>
<p>Random slope model estimates the effect of predictors on the likelihood of receiving antenatal care while allowing both the baseline log-odds and the effect of wealth to vary across communities.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>rs_mod <span class="ot">&lt;-</span> <span class="fu">glmer</span>(</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  antemed <span class="sc">~</span> magec <span class="sc">+</span> magecsq <span class="sc">+</span> meduc2 <span class="sc">+</span> meduc3 <span class="sc">+</span> wealthc <span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">+</span> wealthc <span class="sc">|</span> comm),</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> antenatal,</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="st">"logit"</span>),</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmerControl</span>(<span class="at">calc.derivs =</span> <span class="cn">FALSE</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(rs_mod, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">effect</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">group</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.4547957</td>
<td style="text-align: right;">0.0823495</td>
<td style="text-align: right;">-5.5227510</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-0.6161978</td>
<td style="text-align: right;">-0.2933937</td>
</tr>
<tr class="even">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">magec</td>
<td style="text-align: right;">-0.0001224</td>
<td style="text-align: right;">0.0065341</td>
<td style="text-align: right;">-0.0187312</td>
<td style="text-align: right;">0.9850555</td>
<td style="text-align: right;">-0.0129289</td>
<td style="text-align: right;">0.0126841</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">magecsq</td>
<td style="text-align: right;">-0.0010562</td>
<td style="text-align: right;">0.0006816</td>
<td style="text-align: right;">-1.5494769</td>
<td style="text-align: right;">0.1212671</td>
<td style="text-align: right;">-0.0023921</td>
<td style="text-align: right;">0.0002798</td>
</tr>
<tr class="even">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">meduc2</td>
<td style="text-align: right;">0.5471180</td>
<td style="text-align: right;">0.0846714</td>
<td style="text-align: right;">6.4616647</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.3811651</td>
<td style="text-align: right;">0.7130708</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">meduc3</td>
<td style="text-align: right;">1.3092808</td>
<td style="text-align: right;">0.0968300</td>
<td style="text-align: right;">13.5214429</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1.1194976</td>
<td style="text-align: right;">1.4990641</td>
</tr>
<tr class="even">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">wealthc</td>
<td style="text-align: right;">0.4050956</td>
<td style="text-align: right;">0.0301319</td>
<td style="text-align: right;">13.4440620</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.3460381</td>
<td style="text-align: right;">0.4641531</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ran_pars</td>
<td style="text-align: left;">comm</td>
<td style="text-align: left;">sd__(Intercept)</td>
<td style="text-align: right;">0.9176419</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">ran_pars</td>
<td style="text-align: left;">comm</td>
<td style="text-align: left;">cor__(Intercept).wealthc</td>
<td style="text-align: right;">-0.9988585</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ran_pars</td>
<td style="text-align: left;">comm</td>
<td style="text-align: left;">sd__wealthc</td>
<td style="text-align: right;">0.1194541</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>


</div>
</div>
<hr>
<ul>
<li>The random slope model extends the random intercept model by allowing the slope of <code>wealthc</code> to vary across communities (<code>comm</code>).</li>
<li><strong>(1 + wealthc | comm)</strong>: Specifies random intercepts and random slopes for <code>wealthc</code> within each community.</li>
<li><strong>tidy(rs_mod, conf.int = TRUE)</strong>: Uses the <code>broom.mixed</code> package to tidy the model output and include confidence intervals.</li>
<li><strong>kbl() %&gt;% kable_styling()</strong>: Formats the output into a nice table.</li>
</ul>
</section>
<section id="model-comparison" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="model-comparison"><span class="header-section-number">4.2.3</span> Model Comparison</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(rs_mod, ri_mod, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: antenatal
Models:
ri_mod: antemed ~ magec + magecsq + meduc2 + meduc3 + wealthc + (1 | comm)
rs_mod: antemed ~ magec + magecsq + meduc2 + meduc3 + wealthc + (1 + wealthc | comm)
       npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)   
ri_mod    7 5993.3 6039.4 -2989.7   5979.3                        
rs_mod    9 5987.0 6046.3 -2984.5   5969.0 10.315  2   0.005756 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<hr>
<p><strong>Conclusion</strong>: The p-value (0.005756) is less than 0.05, indicating that the random slope model significantly improves the fit over the random intercept model. Therefore, the effect of wealth varies across communities.</p>
</section>
<section id="interpretation-of-random-slope-model" class="level3" data-number="4.2.4">
<h3 data-number="4.2.4" class="anchored" data-anchor-id="interpretation-of-random-slope-model"><span class="header-section-number">4.2.4</span> Interpretation of Random Slope Model</h3>
<ol type="1">
<li><p><strong>Fixed Effects</strong></p>
<ul>
<li><strong>(Intercept)</strong>: The baseline log-odds of receiving antenatal care is -0.455.</li>
<li><strong>magec</strong>: Mother’s age at child’s birth has a negligible and non-significant effect.</li>
<li><strong>magecsq</strong>: The squared term for mother’s age, also non-significant.</li>
<li><strong>meduc2</strong>: Mothers with primary education have significantly higher log-odds (0.547) of receiving antenatal care compared to those with no education.</li>
<li><strong>meduc3</strong>: Mothers with secondary or higher education have even higher log-odds (1.309) of receiving antenatal care.</li>
<li><strong>wealthc</strong>: Wealth has a significant positive effect on the log-odds (0.405) of receiving antenatal care.</li>
</ul></li>
<li><p><strong>Random Effects</strong></p>
<ul>
<li><strong>sd__(Intercept)</strong>: Standard deviation of the random intercepts for communities is 0.917, indicating variability in the baseline log-odds across communities.</li>
<li><strong>cor__(Intercept).wealthc</strong>: The correlation between the random intercepts and random slopes for wealth is -0.999, indicating a very strong negative relationship.</li>
<li><strong>sd__wealthc</strong>: Standard deviation of the random slopes for wealth is 0.119, indicating variability in the effect of wealth across communities.</li>
</ul></li>
<li><p><strong>Conclusion</strong>: The effect of wealth on the log-odds of receiving antenatal care in Community <span class="math inline">\(j\)</span> is estimated as <span class="math inline">\(0.405 + \hat{u}_{5j}\)</span>, where <span class="math inline">\(\hat{u}_{5j}\)</span> is the random effect for wealth in community <span class="math inline">\(j\)</span>.</p></li>
</ol>
</section>
<section id="random-slope-model-ii" class="level3" data-number="4.2.5">
<h3 data-number="4.2.5" class="anchored" data-anchor-id="random-slope-model-ii"><span class="header-section-number">4.2.5</span> Random Slope Model II</h3>
<p>Fit another random slope model using age and wealth as fixed effects to consider the random effects of wealth and community. This model allows the log-odds of receiving antenatal care to vary both with the woman’s age and wealth and across different communities.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>rs_mod2 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(antemed <span class="sc">~</span> mage <span class="sc">+</span> wealth <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> wealth <span class="sc">|</span> comm),</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="st">"logit"</span>),</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> antenatal,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmerControl</span>(<span class="at">calc.derivs =</span> <span class="cn">FALSE</span>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(rs_mod2, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
  effect   group term  estimate std.error statistic   p.value conf.low conf.high
  &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 fixed    &lt;NA&gt;  (Int…  -0.932    0.168       -5.54  3.02e- 8  -1.26     -0.602 
2 fixed    &lt;NA&gt;  mage   -0.0290   0.00533     -5.44  5.21e- 8  -0.0394   -0.0186
3 fixed    &lt;NA&gt;  weal…   0.575    0.0283      20.3   2.37e-91   0.519     0.630 
4 ran_pars comm  sd__…   1.27    NA           NA    NA         NA        NA     
5 ran_pars comm  cor_…  -0.864   NA           NA    NA         NA        NA     
6 ran_pars comm  sd__…   0.161   NA           NA    NA         NA        NA     </code></pre>
</div>
</div>
<hr>
<ul>
<li><strong>glmer()</strong>: Fits a generalized linear mixed-effects model.</li>
<li><strong>antemed ~ mage + wealth</strong>: Specifies the fixed effects (predictors) as mother’s age (<code>mage</code>) and wealth (<code>wealth</code>).</li>
<li><strong>(1 + wealth | comm)</strong>: Specifies random intercepts and random slopes for wealth within each community (<code>comm</code>). This means both the baseline log-odds and the effect of wealth on antenatal care can vary across communities.</li>
<li><strong>family = binomial(“logit”)</strong>: Specifies that the outcome is binary and the link function is logit.</li>
<li><strong>data = antenatal</strong>: Specifies the dataset to be used.</li>
<li><strong>glmerControl(calc.derivs = FALSE)</strong>: Disables derivative calculations to avoid warnings and speed up estimation.</li>
</ul>
<hr>
<p><strong>Interpretation:</strong></p>
<ol type="1">
<li><p><strong>Fixed Effects:</strong></p>
<ul>
<li><strong>(Intercept)</strong>: The baseline log-odds of receiving antenatal care is -0.932 for a woman with average values of the predictors.</li>
<li><strong>mage</strong>: Each one-year increase in age decreases the log-odds of receiving antenatal care by 0.029, holding wealth and the random effects constant. This effect is statistically significant with a p-value less than 0.05.</li>
<li><strong>wealth</strong>: Each one-unit increase in wealth increases the log-odds of receiving antenatal care by 0.575, holding age and the random effects constant. This effect is statistically significant with a p-value less than 0.05.</li>
</ul></li>
<li><p><strong>Random Effects:</strong></p>
<ul>
<li><strong>sd_(Intercept)</strong>: The standard deviation of the random intercepts for communities is 1.27, indicating variability in the baseline log-odds across communities.</li>
<li><strong>cor_(Intercept).wealth</strong>: The correlation between the random intercepts and random slopes for wealth is -0.864, indicating a strong negative relationship.</li>
<li><strong>sd_wealth</strong>: The standard deviation of the random slopes for wealth is 0.161, indicating variability in the effect of wealth across communities.</li>
</ul></li>
<li><p><strong>Conclusion</strong>:</p>
<ul>
<li><strong>Age</strong>: A one-year increase in age, while controlling for wealth and the random effects of wealth and community, results in a decrease in the log-odds of receiving antenatal care by 0.02899.</li>
<li><strong>Wealth</strong>: A one-unit increase in wealth, while controlling for age and the random effects of wealth and community, results in an increase in the log-odds of receiving antenatal care by 0.5746.</li>
</ul></li>
</ol>
<section id="predicted-log-odds-for-each-woman" class="level4" data-number="4.2.5.1">
<h4 data-number="4.2.5.1" class="anchored" data-anchor-id="predicted-log-odds-for-each-woman"><span class="header-section-number">4.2.5.1</span> Predicted Log-Odds for Each Woman</h4>
<p>The predicted log-odds for each woman are calculated by combining the fixed effects (coefficients for the predictors like age and wealth) with the random effects (community-specific deviations).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>pred_rs_mod2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(rs_mod2, <span class="at">type =</span> <span class="st">"link"</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pred_rs_mod2, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          1           2           3           4           5           6 
-0.16725965  0.76111534 -0.54475899 -0.60274590  0.29722006  0.52916770 
          7           8           9          10 
-0.37079826 -0.05128583  0.23864872  0.81910225 </code></pre>
</div>
</div>
<hr>
<ul>
<li><strong>predict(rs_mod2, type = ‘link’)</strong>: Predicts the log-odds of receiving antenatal care for each woman in the dataset using the fitted model.</li>
<li><strong>head(pred_rs_mod2, 10)</strong>: Displays the first 10 predicted log-odds.</li>
</ul>
</section>
<section id="manual-calculation-for-predicted-log-odds" class="level4" data-number="4.2.5.2">
<h4 data-number="4.2.5.2" class="anchored" data-anchor-id="manual-calculation-for-predicted-log-odds"><span class="header-section-number">4.2.5.2</span> Manual Calculation for Predicted Log-Odds</h4>
<p>The log-odds for each woman can be manually calculated by combining the fixed and random effects. For example, for a woman in community 1 with specific values for age and wealth:</p>
<ol type="1">
<li><strong>Fixed Effects:</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(rs_mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)        mage      wealth 
-0.93167558 -0.02899346  0.57458998 </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Intercept</strong>: -0.93168554</p>
<p><strong>Age (mage)</strong>: -0.02899327 per year</p>
<p><strong>Wealth</strong>: 0.57459232 per unit</p>
</div>
</div>
<ol start="2" type="1">
<li><strong>Random Effects for Community 1:</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">ranef</span>(rs_mod2)<span class="sc">$</span>comm, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)      wealth
1 -0.02016062 0.005863546
2 -0.80176940 0.079342713
3 -0.95036676 0.092111860</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Intercept</strong>: -0.02016042</p>
<p><strong>Wealth</strong>: 0.005863202</p>
</div>
</div>
<ol start="3" type="1">
<li><strong>Log-Odds Calculation for Each Woman:</strong></li>
</ol>
<p>For the first woman in community 1 with age 33 and wealth 3: <span class="math display">\[
(\text{Intercept} + u_{0}) + (\beta_{\text{mage}} \cdot \text{mage}) + (\beta_{\text{wealth}} + u_{\text{wealth}}) \cdot \text{wealth}
\]</span></p>
<p><span class="math display">\[
(-0.93168554 + -0.02016042) + (-0.02899327 \cdot 33) + (0.57459232 + 0.005863202) \cdot 3
\]</span></p>
<p><span class="math display">\[
= -0.1672498
\]</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>For the second woman in community 1 with age 21 and wealth 4: <span class="math inline">\(= 0.7611214\)</span></p>
<p>For the third woman in community 1 with age 26 and wealth 2: <span class="math inline">\(= -0.544754\)</span></p>
</div>
</div>
</section>
</section>
</section>
<section id="plots-1" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="plots-1"><span class="header-section-number">4.3</span> Plots</h2>
<p>These plots provide valuable insights into the model’s results, making it easier to interpret and communicate the effects of different predictors and the variability across different groups or communities.</p>
<section id="fixed-effects-plot" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="fixed-effects-plot"><span class="header-section-number">4.3.1</span> Fixed Effects Plot</h3>
<p>The fixed effects plot visualizes the estimated fixed effects from the model, showing how predictors like age and wealth influence the log-odds of receiving antenatal care across the entire population.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create fixed effects plot</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(rs_mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Mixed-Effect-Models_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="random-effect-plot-1" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="random-effect-plot-1"><span class="header-section-number">4.3.2</span> Random Effect Plot</h3>
<p>The random effects plot visualizes the estimated random effects for different communities, along with their confidence intervals. It helps in understanding the variability in the effects across communities.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The `ranef` function extracts the random effects from the fitted model `rs_mod2`</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>re_rs_mod2 <span class="ot">&lt;-</span> <span class="fu">ranef</span>(rs_mod2)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The `augment` function adds additional information</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>cater_re_rs_mod2 <span class="ot">&lt;-</span> <span class="fu">augment</span>(re_rs_mod2)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create random effects plot</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cater_re_rs_mod2, <span class="fu">aes</span>(estimate, qq, <span class="at">xmin =</span> lb, <span class="at">xmax =</span> ub)) <span class="sc">+</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="at">height =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scale =</span> <span class="st">"free_x"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Mixed-Effect-Models_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
<ul>
<li><strong>ggplot</strong>: The main function from the <code>ggplot2</code> package used for creating the plot.</li>
<li><strong>aes(estimate, qq, xmin = lb, xmax = ub)</strong>: Sets up the aesthetic mappings. Here, <code>estimate</code> is the estimated random effect, <code>qq</code> is the quantile, <code>xmin</code> and <code>xmax</code> represent the lower and upper bounds of the confidence intervals, respectively.</li>
<li><strong>geom_errorbarh(height = 0)</strong>: Adds horizontal error bars to represent the confidence intervals of the random effects.</li>
<li><strong>geom_point()</strong>: Adds points to represent the estimated random effects.</li>
<li><strong>facet_wrap(~variable, scale = “free_x”)</strong>: Creates separate panels for each variable’s random effects, allowing the x-axis scale to vary for each panel.</li>
</ul>
</section>
<section id="plotting-the-predicted-values-and-marginal-effects" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="plotting-the-predicted-values-and-marginal-effects"><span class="header-section-number">4.3.3</span> Plotting the Predicted Values and Marginal Effects</h3>
<p>These plots help visualize the relationship between the predictors (mother’s age and wealth) and the predicted probability of receiving antenatal care, providing insights into how these factors influence the outcome.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots predicted values for the mother's age</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(rs_mod2, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">vars =</span> <span class="st">"mage"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$mage</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Mixed-Effect-Models_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$wealth</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Mixed-Effect-Models_files/figure-html/unnamed-chunk-31-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>This code creates a plot showing the predicted values of receiving antenatal care based on the mother’s age.</p></li>
<li><p><strong>plot_model</strong>: This function from the <code>sjPlot</code> package is used to create various types of plots for regression models.</p>
<ul>
<li><strong>rs_mod2</strong>: This is the fitted mixed-effects logistic regression model.</li>
<li><strong>type = “pred”</strong>: Specifies that the plot should display predicted values.</li>
<li><strong>vars = “mage”</strong>: Indicates that the plot should show the predicted values for the variable “mage” (mother’s age).</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots predicted values for the wealth index</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(rs_mod2, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">vars =</span> <span class="st">"wealth"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$mage</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Mixed-Effect-Models_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$wealth</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Mixed-Effect-Models_files/figure-html/unnamed-chunk-32-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>This code creates a plot showing the predicted values of receiving antenatal care based on the wealth index.</li>
<li><strong>vars = “wealth”</strong>: Indicates that the plot should show the predicted values for the variable “wealth”.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots predicted values for both the mother's age and the wealth index in separate panels</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(rs_mod2, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">"mage"</span>, <span class="st">"wealth"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$mage</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Mixed-Effect-Models_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$wealth</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Mixed-Effect-Models_files/figure-html/unnamed-chunk-33-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>This code creates a plot showing the predicted values of receiving antenatal care based on both the mother’s age and the wealth index.</li>
<li><strong>vars = c(“mage”, “wealth”)</strong>: Indicates that the plot should show the predicted values for both “mage” and “wealth”.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots predicted values for both the mother's age and the wealth index on the same plot</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(rs_mod2, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">"mage"</span>, <span class="st">"wealth"</span>), <span class="at">facet.grid =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$mage</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Mixed-Effect-Models_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$wealth</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Mixed-Effect-Models_files/figure-html/unnamed-chunk-34-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>This code creates a combined plot showing the predicted values of receiving antenatal care based on both the mother’s age and the wealth index, without using separate panels for each variable.</li>
<li><strong>facet.grid = FALSE</strong>: Disables faceting, so both variables will be displayed on the same plot rather than in separate panels.</li>
</ul>
</section>
</section>
</section>
<section id="longitudinal-data" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Longitudinal Data</h1>
<p>Longitudinal data involves repeated observations of the same subjects over time, allowing researchers to examine changes within subjects and the effects of time-dependent variables. Longitudinal data is collected in multiple waves or at several time points, providing a rich dataset for analyzing trends, patterns, and causal relationships.</p>
<section id="dataset-overview-2" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="dataset-overview-2"><span class="header-section-number">5.1</span> Dataset Overview</h2>
<p>The toenail dataset is used to examine longitudinal data where the outcome of interest is in binary form. This dataset is sourced from the HSAUR book and package and is also detailed in Chapter 10 of Multilevel and Longitudinal Modelling Using Stata.</p>
<p>The outcome variable measures the condition of the toenail and is binary (dichotomous), with categories: none or mild, and moderate or severe. This outcome captures whether the toenail condition is relatively mild or more severe.</p>
<p>The primary covariate in the study is the treatment received by the subjects. This variable indicates the type of treatment administered and is expected to influence the toenail condition over time.</p>
<ol type="1">
<li><p>Variables in the Dataset:</p>
<ul>
<li><strong>Outcome:</strong> Toenail condition (none or mild vs.&nbsp;moderate or severe).</li>
<li><strong>Treatment:</strong> Type of treatment administered to the patients.</li>
<li><strong>Visit:</strong> The time point at which the measurement was taken.</li>
<li><strong>PatientID:</strong> Unique identifier for each patient.</li>
</ul></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(toenail)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(toenail)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   patientID                  outcome            treatment        time       
 1      :   7   none or mild      :1500   itraconazole:937   Min.   : 0.000  
 3      :   7   moderate or severe: 408   terbinafine :971   1st Qu.: 1.000  
 4      :   7                                                Median : 3.000  
 6      :   7                                                Mean   : 4.691  
 7      :   7                                                3rd Qu.: 8.893  
 9      :   7                                                Max.   :18.500  
 (Other):1866                                                                
     visit      
 Min.   :1.000  
 1st Qu.:2.000  
 Median :4.000  
 Mean   :3.896  
 3rd Qu.:6.000  
 Max.   :7.000  
                </code></pre>
</div>
</div>
<ol start="2" type="1">
<li><p>Hierarchical Structure:</p>
<ul>
<li><p><strong>Level 1 (visit):</strong> This level represents repeated measurements or visits for each subject. Each visit provides a snapshot of the toenail condition and the treatment status at that point in time.</p></li>
<li><p><strong>Level 2 (patientID):</strong> This level represents individual patients, with each patient having a unique identifier. The repeated visits for each patient are nested within this identifier, allowing for the analysis of within-patient changes over time.</p></li>
</ul></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>toenail <span class="sc">%&gt;%</span> <span class="fu">count</span>(visit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  visit   n
1     1 294
2     2 288
3     3 283
4     4 272
5     5 263
6     6 244
7     7 264</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>toenail <span class="sc">%&gt;%</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(visit, patientID) <span class="sc">%&gt;%</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-b0a6ad95665ab38aa059" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b0a6ad95665ab38aa059">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629","630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654","655","656","657","658","659","660","661","662","663","664","665","666","667","668","669","670","671","672","673","674","675","676","677","678","679","680","681","682","683","684","685","686","687","688","689","690","691","692","693","694","695","696","697","698","699","700","701","702","703","704","705","706","707","708","709","710","711","712","713","714","715","716","717","718","719","720","721","722","723","724","725","726","727","728","729","730","731","732","733","734","735","736","737","738","739","740","741","742","743","744","745","746","747","748","749","750","751","752","753","754","755","756","757","758","759","760","761","762","763","764","765","766","767","768","769","770","771","772","773","774","775","776","777","778","779","780","781","782","783","784","785","786","787","788","789","790","791","792","793","794","795","796","797","798","799","800","801","802","803","804","805","806","807","808","809","810","811","812","813","814","815","816","817","818","819","820","821","822","823","824","825","826","827","828","829","830","831","832","833","834","835","836","837","838","839","840","841","842","843","844","845","846","847","848","849","850","851","852","853","854","855","856","857","858","859","860","861","862","863","864","865","866","867","868","869","870","871","872","873","874","875","876","877","878","879","880","881","882","883","884","885","886","887","888","889","890","891","892","893","894","895","896","897","898","899","900","901","902","903","904","905","906","907","908","909","910","911","912","913","914","915","916","917","918","919","920","921","922","923","924","925","926","927","928","929","930","931","932","933","934","935","936","937","938","939","940","941","942","943","944","945","946","947","948","949","950","951","952","953","954","955","956","957","958","959","960","961","962","963","964","965","966","967","968","969","970","971","972","973","974","975","976","977","978","979","980","981","982","983","984","985","986","987","988","989","990","991","992","993","994","995","996","997","998","999","1000","1001","1002","1003","1004","1005","1006","1007","1008","1009","1010","1011","1012","1013","1014","1015","1016","1017","1018","1019","1020","1021","1022","1023","1024","1025","1026","1027","1028","1029","1030","1031","1032","1033","1034","1035","1036","1037","1038","1039","1040","1041","1042","1043","1044","1045","1046","1047","1048","1049","1050","1051","1052","1053","1054","1055","1056","1057","1058","1059","1060","1061","1062","1063","1064","1065","1066","1067","1068","1069","1070","1071","1072","1073","1074","1075","1076","1077","1078","1079","1080","1081","1082","1083","1084","1085","1086","1087","1088","1089","1090","1091","1092","1093","1094","1095","1096","1097","1098","1099","1100","1101","1102","1103","1104","1105","1106","1107","1108","1109","1110","1111","1112","1113","1114","1115","1116","1117","1118","1119","1120","1121","1122","1123","1124","1125","1126","1127","1128","1129","1130","1131","1132","1133","1134","1135","1136","1137","1138","1139","1140","1141","1142","1143","1144","1145","1146","1147","1148","1149","1150","1151","1152","1153","1154","1155","1156","1157","1158","1159","1160","1161","1162","1163","1164","1165","1166","1167","1168","1169","1170","1171","1172","1173","1174","1175","1176","1177","1178","1179","1180","1181","1182","1183","1184","1185","1186","1187","1188","1189","1190","1191","1192","1193","1194","1195","1196","1197","1198","1199","1200","1201","1202","1203","1204","1205","1206","1207","1208","1209","1210","1211","1212","1213","1214","1215","1216","1217","1218","1219","1220","1221","1222","1223","1224","1225","1226","1227","1228","1229","1230","1231","1232","1233","1234","1235","1236","1237","1238","1239","1240","1241","1242","1243","1244","1245","1246","1247","1248","1249","1250","1251","1252","1253","1254","1255","1256","1257","1258","1259","1260","1261","1262","1263","1264","1265","1266","1267","1268","1269","1270","1271","1272","1273","1274","1275","1276","1277","1278","1279","1280","1281","1282","1283","1284","1285","1286","1287","1288","1289","1290","1291","1292","1293","1294","1295","1296","1297","1298","1299","1300","1301","1302","1303","1304","1305","1306","1307","1308","1309","1310","1311","1312","1313","1314","1315","1316","1317","1318","1319","1320","1321","1322","1323","1324","1325","1326","1327","1328","1329","1330","1331","1332","1333","1334","1335","1336","1337","1338","1339","1340","1341","1342","1343","1344","1345","1346","1347","1348","1349","1350","1351","1352","1353","1354","1355","1356","1357","1358","1359","1360","1361","1362","1363","1364","1365","1366","1367","1368","1369","1370","1371","1372","1373","1374","1375","1376","1377","1378","1379","1380","1381","1382","1383","1384","1385","1386","1387","1388","1389","1390","1391","1392","1393","1394","1395","1396","1397","1398","1399","1400","1401","1402","1403","1404","1405","1406","1407","1408","1409","1410","1411","1412","1413","1414","1415","1416","1417","1418","1419","1420","1421","1422","1423","1424","1425","1426","1427","1428","1429","1430","1431","1432","1433","1434","1435","1436","1437","1438","1439","1440","1441","1442","1443","1444","1445","1446","1447","1448","1449","1450","1451","1452","1453","1454","1455","1456","1457","1458","1459","1460","1461","1462","1463","1464","1465","1466","1467","1468","1469","1470","1471","1472","1473","1474","1475","1476","1477","1478","1479","1480","1481","1482","1483","1484","1485","1486","1487","1488","1489","1490","1491","1492","1493","1494","1495","1496","1497","1498","1499","1500","1501","1502","1503","1504","1505","1506","1507","1508","1509","1510","1511","1512","1513","1514","1515","1516","1517","1518","1519","1520","1521","1522","1523","1524","1525","1526","1527","1528","1529","1530","1531","1532","1533","1534","1535","1536","1537","1538","1539","1540","1541","1542","1543","1544","1545","1546","1547","1548","1549","1550","1551","1552","1553","1554","1555","1556","1557","1558","1559","1560","1561","1562","1563","1564","1565","1566","1567","1568","1569","1570","1571","1572","1573","1574","1575","1576","1577","1578","1579","1580","1581","1582","1583","1584","1585","1586","1587","1588","1589","1590","1591","1592","1593","1594","1595","1596","1597","1598","1599","1600","1601","1602","1603","1604","1605","1606","1607","1608","1609","1610","1611","1612","1613","1614","1615","1616","1617","1618","1619","1620","1621","1622","1623","1624","1625","1626","1627","1628","1629","1630","1631","1632","1633","1634","1635","1636","1637","1638","1639","1640","1641","1642","1643","1644","1645","1646","1647","1648","1649","1650","1651","1652","1653","1654","1655","1656","1657","1658","1659","1660","1661","1662","1663","1664","1665","1666","1667","1668","1669","1670","1671","1672","1673","1674","1675","1676","1677","1678","1679","1680","1681","1682","1683","1684","1685","1686","1687","1688","1689","1690","1691","1692","1693","1694","1695","1696","1697","1698","1699","1700","1701","1702","1703","1704","1705","1706","1707","1708","1709","1710","1711","1712","1713","1714","1715","1716","1717","1718","1719","1720","1721","1722","1723","1724","1725","1726","1727","1728","1729","1730","1731","1732","1733","1734","1735","1736","1737","1738","1739","1740","1741","1742","1743","1744","1745","1746","1747","1748","1749","1750","1751","1752","1753","1754","1755","1756","1757","1758","1759","1760","1761","1762","1763","1764","1765","1766","1767","1768","1769","1770","1771","1772","1773","1774","1775","1776","1777","1778","1779","1780","1781","1782","1783","1784","1785","1786","1787","1788","1789","1790","1791","1792","1793","1794","1795","1796","1797","1798","1799","1800","1801","1802","1803","1804","1805","1806","1807","1808","1809","1810","1811","1812","1813","1814","1815","1816","1817","1818","1819","1820","1821","1822","1823","1824","1825","1826","1827","1828","1829","1830","1831","1832","1833","1834","1835","1836","1837","1838","1839","1840","1841","1842","1843","1844","1845","1846","1847","1848","1849","1850","1851","1852","1853","1854","1855","1856","1857","1858","1859","1860","1861","1862","1863","1864","1865","1866","1867","1868","1869","1870","1871","1872","1873","1874","1875","1876","1877","1878","1879","1880","1881","1882","1883","1884","1885","1886","1887","1888","1889","1890","1891","1892","1893","1894","1895","1896","1897","1898","1899","1900","1901","1902","1903","1904","1905","1906","1907","1908"],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],["1","2","3","4","6","7","9","10","11","12","13","15","16","17","18","19","20","21","22","23","24","25","28","29","30","31","33","35","37","38","39","40","41","45","48","49","50","51","52","53","54","55","56","58","59","60","61","63","64","65","66","68","69","70","72","73","75","76","78","79","80","81","82","83","84","85","86","87","88","89","90","93","94","95","96","97","99","101","102","104","105","106","107","108","109","110","111","114","116","117","118","119","120","123","124","125","126","127","129","131","132","133","134","136","137","138","139","140","141","142","143","144","145","146","149","150","151","152","154","156","157","158","160","161","162","163","164","165","166","168","169","170","172","173","174","175","176","177","178","180","181","182","185","186","188","189","190","191","192","193","194","195","197","198","199","200","201","202","203","204","205","206","207","209","210","211","212","213","214","215","216","217","218","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","237","239","240","241","242","243","245","246","247","248","249","250","251","252","254","255","256","258","259","260","261","262","263","264","266","269","270","271","273","275","276","277","278","279","283","284","287","288","289","290","292","293","294","295","297","298","300","301","302","305","306","307","308","309","310","311","312","313","314","316","319","321","324","325","327","328","330","331","332","333","334","335","336","337","338","340","341","343","346","350","351","352","353","354","355","356","357","358","359","360","361","363","364","365","366","367","368","369","372","373","374","377","381","382","383","1","2","3","4","6","7","9","10","11","12","13","15","16","17","18","19","20","21","22","23","24","25","28","29","30","31","33","35","37","38","39","40","41","49","50","51","52","53","54","55","56","58","59","60","61","64","65","66","68","69","70","72","73","75","76","78","79","80","81","82","83","84","85","86","87","88","89","90","93","94","95","96","97","101","102","104","105","106","107","108","109","110","111","114","116","117","118","119","120","123","124","125","126","127","129","131","132","133","134","136","137","138","139","140","141","142","143","144","145","146","149","150","151","152","154","156","157","158","160","161","162","163","164","165","166","168","169","170","172","173","174","175","176","177","178","180","181","182","185","186","188","189","190","191","192","193","194","195","197","198","199","200","201","202","203","204","205","206","207","209","210","211","212","213","214","215","216","217","218","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","237","239","240","241","242","243","245","246","247","248","249","250","251","252","254","255","256","258","259","260","261","262","263","264","266","269","270","271","273","275","276","277","278","279","283","284","287","288","289","290","292","293","294","295","297","298","300","301","302","305","306","307","308","309","310","311","312","313","314","316","319","321","324","325","327","328","330","331","332","333","334","335","336","337","338","340","341","343","346","350","351","352","353","354","355","356","358","359","360","361","363","364","365","366","367","368","369","372","373","374","381","382","383","1","2","3","4","6","7","9","10","11","12","13","15","16","17","18","19","20","21","22","23","24","25","28","29","30","31","33","35","37","38","39","40","49","50","51","52","53","54","55","56","58","59","60","61","64","65","66","68","69","70","72","73","75","76","78","79","80","81","82","83","84","85","86","87","88","89","90","94","95","96","97","101","102","104","105","106","107","108","109","110","111","114","116","117","118","119","120","123","124","125","126","127","129","131","132","133","134","136","137","138","139","140","141","142","143","144","145","146","149","150","151","152","154","156","157","158","160","161","162","163","164","165","166","168","169","170","172","173","174","175","176","177","178","180","181","182","185","186","188","189","190","191","192","193","194","195","197","198","199","200","201","202","203","204","205","206","207","209","210","211","212","213","214","215","216","217","218","220","221","222","223","224","225","226","228","229","230","231","232","233","234","235","237","239","240","241","242","243","245","247","248","249","250","251","252","254","255","256","258","259","260","261","262","263","264","266","269","270","271","273","275","276","277","278","279","283","284","287","288","290","292","293","294","295","297","298","300","301","302","305","306","307","308","310","311","312","313","314","316","319","321","324","325","327","328","330","331","332","333","334","335","336","337","338","340","341","343","346","350","351","352","353","354","355","356","357","358","359","360","361","363","364","365","366","367","368","369","372","373","374","381","382","383","1","2","3","4","6","7","9","10","11","12","13","15","16","17","19","22","23","25","28","29","30","33","35","37","38","39","40","50","51","52","53","54","55","56","58","59","61","64","65","66","68","69","70","72","73","75","76","78","79","80","81","82","83","84","85","86","87","88","89","90","94","95","96","97","101","102","104","105","106","107","108","109","110","111","114","116","117","118","119","120","123","124","125","126","127","129","131","132","133","134","136","137","138","139","140","141","142","143","144","145","146","149","150","151","152","154","156","157","158","160","161","162","163","164","166","168","169","170","172","173","174","175","176","177","178","180","181","182","185","186","188","189","190","191","192","193","194","195","197","198","199","200","201","202","203","204","205","206","209","210","211","212","213","215","216","217","218","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","237","239","240","241","242","243","245","247","248","249","251","252","254","255","256","258","259","260","261","262","263","264","266","269","270","271","273","275","276","277","278","279","283","284","287","288","289","290","292","293","294","295","297","298","300","301","302","305","306","307","308","310","311","312","313","314","316","319","324","325","327","328","330","331","332","333","334","335","336","337","340","341","343","346","350","351","352","353","354","355","356","357","358","359","360","361","363","364","365","366","367","368","369","372","373","374","381","382","383","1","2","3","4","6","7","9","10","11","12","13","15","17","18","19","20","22","23","24","25","28","29","33","35","37","38","39","40","41","49","50","51","52","53","54","55","56","59","60","64","65","66","68","69","70","72","73","75","76","78","79","80","81","82","83","84","85","86","87","88","89","90","94","95","96","97","101","102","104","105","106","107","108","109","110","111","114","116","117","118","119","120","123","124","125","126","127","129","131","132","133","134","136","137","138","139","140","141","142","143","144","145","146","149","150","151","152","154","156","157","158","160","161","162","163","164","166","169","170","172","173","174","175","176","177","178","180","182","185","190","191","193","194","195","197","198","199","200","201","202","203","204","205","206","207","209","210","211","212","213","215","216","217","218","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","237","239","240","241","242","243","245","247","249","251","252","254","255","256","258","259","260","261","262","263","264","266","269","270","271","273","275","276","277","278","279","283","287","288","289","290","292","293","294","295","297","298","301","302","305","306","307","308","310","311","312","313","316","319","324","325","327","328","330","331","333","334","335","336","337","340","341","346","350","351","352","353","354","355","356","357","358","359","360","361","363","364","365","366","367","368","369","372","373","374","381","382","383","1","2","3","4","6","7","9","10","11","12","13","16","18","19","20","22","23","25","29","30","33","37","38","39","50","52","53","54","55","56","59","60","64","65","66","69","70","72","73","75","76","79","80","81","82","83","84","85","86","87","88","89","90","94","95","96","101","102","104","105","106","107","108","109","110","111","114","116","117","119","120","123","124","125","126","127","129","131","132","134","136","137","138","139","140","141","142","143","144","145","146","149","150","151","152","154","156","157","158","160","161","162","163","164","166","168","169","170","172","173","174","175","177","178","180","181","182","185","186","188","189","190","191","192","193","194","195","197","198","200","201","202","203","204","205","206","209","210","211","212","215","216","217","218","220","221","222","223","224","225","226","227","228","229","231","232","233","234","235","237","239","241","242","243","245","250","251","252","255","256","258","259","260","261","262","263","264","266","269","270","271","273","275","276","277","279","283","284","287","288","289","292","293","294","295","297","298","301","302","308","310","311","313","316","319","324","325","327","328","330","331","332","333","334","335","336","337","340","341","346","350","351","353","354","355","356","357","358","359","360","361","363","364","365","366","367","368","369","372","373","374","381","382","383","1","3","4","6","7","9","10","11","12","13","15","16","17","18","19","20","22","23","25","28","29","30","33","35","37","38","39","40","50","51","52","53","54","55","56","59","60","64","65","66","69","70","72","73","75","76","78","79","80","81","82","83","84","85","86","87","88","89","90","94","95","96","97","101","102","104","105","106","107","108","109","110","111","114","116","117","119","120","123","124","125","126","127","129","131","132","134","136","137","138","139","140","141","142","143","144","145","146","149","150","151","152","154","156","157","158","160","161","162","163","164","166","168","169","170","172","173","174","175","176","177","178","180","181","182","185","186","188","189","190","191","192","193","194","195","197","198","199","200","201","202","203","204","205","206","207","209","210","211","213","215","216","217","218","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","237","239","240","241","242","243","245","247","248","250","251","252","254","255","256","258","259","260","261","262","263","264","266","269","270","271","273","275","276","277","278","279","283","284","287","288","290","292","293","294","295","297","298","300","301","302","305","306","307","308","310","311","312","313","316","319","324","325","327","328","330","331","332","333","334","335","336","337","340","341","346","350","351","353","354","355","356","357","358","359","360","361","363","364","365","366","367","368","369","372","373","374","381","382"],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>visit<\/th>\n      <th>patientID<\/th>\n      <th>n<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,3]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"visit","targets":1},{"name":"patientID","targets":2},{"name":"n","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="exploratory-data-analysis" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="exploratory-data-analysis"><span class="header-section-number">5.2</span> Exploratory Data Analysis</h2>
<section id="descriptive-analysis" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="descriptive-analysis"><span class="header-section-number">5.2.1</span> Descriptive Analysis</h3>
<p>Describe the data and get an overview of its contents. Display the first 30 observations in the dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>toenail <span class="sc">%&gt;%</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">patientID</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">outcome</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">treatment</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">time</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">visit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">moderate or severe</td>
<td style="text-align: left;">terbinafine</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">moderate or severe</td>
<td style="text-align: left;">terbinafine</td>
<td style="text-align: right;">0.8571429</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">moderate or severe</td>
<td style="text-align: left;">terbinafine</td>
<td style="text-align: right;">3.5357140</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">none or mild</td>
<td style="text-align: left;">terbinafine</td>
<td style="text-align: right;">4.5357140</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">none or mild</td>
<td style="text-align: left;">terbinafine</td>
<td style="text-align: right;">7.5357140</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">none or mild</td>
<td style="text-align: left;">terbinafine</td>
<td style="text-align: right;">10.0357100</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">none or mild</td>
<td style="text-align: left;">terbinafine</td>
<td style="text-align: right;">13.0714300</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">none or mild</td>
<td style="text-align: left;">itraconazole</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">none or mild</td>
<td style="text-align: left;">itraconazole</td>
<td style="text-align: right;">0.9642857</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">moderate or severe</td>
<td style="text-align: left;">itraconazole</td>
<td style="text-align: right;">2.0000000</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">moderate or severe</td>
<td style="text-align: left;">itraconazole</td>
<td style="text-align: right;">3.0357140</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">none or mild</td>
<td style="text-align: left;">itraconazole</td>
<td style="text-align: right;">6.5000000</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">none or mild</td>
<td style="text-align: left;">itraconazole</td>
<td style="text-align: right;">9.0000000</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">none or mild</td>
<td style="text-align: left;">itraconazole</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">none or mild</td>
<td style="text-align: left;">itraconazole</td>
<td style="text-align: right;">1.2500000</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">none or mild</td>
<td style="text-align: left;">itraconazole</td>
<td style="text-align: right;">2.1071430</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">none or mild</td>
<td style="text-align: left;">itraconazole</td>
<td style="text-align: right;">3.2500000</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">none or mild</td>
<td style="text-align: left;">itraconazole</td>
<td style="text-align: right;">6.7500000</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">none or mild</td>
<td style="text-align: left;">itraconazole</td>
<td style="text-align: right;">9.0357140</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">moderate or severe</td>
<td style="text-align: left;">itraconazole</td>
<td style="text-align: right;">11.5000000</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: left;">moderate or severe</td>
<td style="text-align: left;">itraconazole</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">none or mild</td>
<td style="text-align: left;">itraconazole</td>
<td style="text-align: right;">1.0714290</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: left;">none or mild</td>
<td style="text-align: left;">itraconazole</td>
<td style="text-align: right;">2.0714290</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">none or mild</td>
<td style="text-align: left;">itraconazole</td>
<td style="text-align: right;">3.5714290</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: left;">none or mild</td>
<td style="text-align: left;">itraconazole</td>
<td style="text-align: right;">6.8214290</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">none or mild</td>
<td style="text-align: left;">itraconazole</td>
<td style="text-align: right;">9.9285720</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: left;">none or mild</td>
<td style="text-align: left;">itraconazole</td>
<td style="text-align: right;">12.9285700</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: left;">moderate or severe</td>
<td style="text-align: left;">terbinafine</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: left;">moderate or severe</td>
<td style="text-align: left;">terbinafine</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: left;">moderate or severe</td>
<td style="text-align: left;">terbinafine</td>
<td style="text-align: right;">1.9285710</td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="data-visualization" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="data-visualization"><span class="header-section-number">5.2.2</span> Data Visualization</h3>
<p>The visualization step involves plotting the distribution of the outcome variable across different visits and treatments to get a better understanding of the data. Generate a bar plot where the x-axis represents the visit number, the bars are filled based on the outcome severity, and the plots are faceted by treatment group.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(toenail, <span class="fu">aes</span>(visit)) <span class="sc">+</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill =</span> outcome)) <span class="sc">+</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> treatment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Mixed-Effect-Models_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="estimation-2" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="estimation-2"><span class="header-section-number">5.3</span> Estimation</h2>
<section id="population-average-model-1" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="population-average-model-1"><span class="header-section-number">5.3.1</span> Population Average Model</h3>
<p>The analysis focuses on examining the longitudinal data, using the primary covariate (treatment) to assess its impact on the outcome over multiple visits for each patient. The hierarchical structure includes the repeated measures (visits) nested within patients. For the estimation of the population average model, Generalized Estimating Equations (GEE) will be used.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Conversion of Outcome Variable</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>toenail2 <span class="ot">&lt;-</span> toenail <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">outcome2 =</span> <span class="fu">as.integer</span>(outcome) <span class="sc">-</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>The binary outcome variable <code>outcome</code> is converted to a numerical variable <code>outcome2</code>.</li>
<li>This is done using the <code>mutate</code> function from the <code>dplyr</code> package to ensure the GEE function can process it.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Running the GEE Model</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>gee_toe <span class="ot">&lt;-</span> <span class="fu">gee</span>(outcome2 <span class="sc">~</span> treatment <span class="sc">+</span> visit,</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> patientID,</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> toenail2,</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> binomial,</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">corstr =</span> <span class="st">"exchangeable"</span>,</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">scale.fix =</span> <span class="cn">TRUE</span>,</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">scale.value =</span> <span class="dv">1</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         (Intercept) treatmentterbinafine                visit 
           0.1212395           -0.1847071           -0.3836050 </code></pre>
</div>
</div>
<ul>
<li>The <code>gee</code> function is used to fit the GEE model.</li>
<li>The outcome variable is <code>outcome2</code>, and the predictors are <code>treatment</code> and <code>visit</code>.</li>
<li>The data used is the <code>toenail</code> dataset.</li>
<li>The correlation structure is specified as <code>exchangeable</code>, indicating that the correlation between any two observations from the same subject is assumed to be constant.</li>
<li>The scale is fixed (<code>scale.fix = TRUE</code>), and the scale value is set to 1 (<code>scale.value = 1</code>).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the GEE Model</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gee_toe)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Logit 
 Variance to Mean Relation: Binomial 
 Correlation Structure:     Exchangeable 

Call:
gee(formula = outcome2 ~ treatment + visit, id = patientID, data = toenail2, 
    family = binomial, corstr = "exchangeable", scale.fix = TRUE, 
    scale.value = 1)

Summary of Residuals:
        Min          1Q      Median          3Q         Max 
-0.41898833 -0.25030563 -0.13513108 -0.06813592  0.93186408 


Coefficients:
                        Estimate Naive S.E.      Naive z Robust S.E.
(Intercept)           0.05274712 0.14384155   0.36670296  0.19562332
treatmentterbinafine -0.01070541 0.19346770  -0.05533435  0.24758512
visit                -0.37967489 0.02672029 -14.20923738  0.03629291
                         Robust z
(Intercept)            0.26963616
treatmentterbinafine  -0.04323931
visit                -10.46140636

Estimated Scale Parameter:  1
Number of Iterations:  4

Working Correlation
          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
[1,] 1.0000000 0.4404066 0.4404066 0.4404066 0.4404066 0.4404066 0.4404066
[2,] 0.4404066 1.0000000 0.4404066 0.4404066 0.4404066 0.4404066 0.4404066
[3,] 0.4404066 0.4404066 1.0000000 0.4404066 0.4404066 0.4404066 0.4404066
[4,] 0.4404066 0.4404066 0.4404066 1.0000000 0.4404066 0.4404066 0.4404066
[5,] 0.4404066 0.4404066 0.4404066 0.4404066 1.0000000 0.4404066 0.4404066
[6,] 0.4404066 0.4404066 0.4404066 0.4404066 0.4404066 1.0000000 0.4404066
[7,] 0.4404066 0.4404066 0.4404066 0.4404066 0.4404066 0.4404066 1.0000000</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparison with Independence Structure</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>gee_toe_ind <span class="ot">&lt;-</span> <span class="fu">gee</span>(outcome2 <span class="sc">~</span> treatment <span class="sc">+</span> visit,</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> patientID,</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> toenail2,</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> binomial,</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">corstr =</span> <span class="st">"independence"</span>,</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">scale.fix =</span> <span class="cn">TRUE</span>,</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">scale.value =</span> <span class="dv">1</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         (Intercept) treatmentterbinafine                visit 
           0.1212395           -0.1847071           -0.3836050 </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>An additional GEE model is fitted with an <code>independence</code> correlation structure to compare the effects.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gee_toe_ind)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Logit 
 Variance to Mean Relation: Binomial 
 Correlation Structure:     Independent 

Call:
gee(formula = outcome2 ~ treatment + visit, id = patientID, data = toenail2, 
    family = binomial, corstr = "independence", scale.fix = TRUE, 
    scale.value = 1)

Summary of Residuals:
        Min          1Q      Median          3Q         Max 
-0.43478231 -0.22894417 -0.12115981 -0.06015996  0.93984004 


Coefficients:
                       Estimate Naive S.E.     Naive z Robust S.E.    Robust z
(Intercept)           0.1212395 0.12959511   0.9355254  0.18615533   0.6512815
treatmentterbinafine -0.1847071 0.11677873  -1.5816843  0.21984572  -0.8401668
visit                -0.3836050 0.03242287 -11.8313097  0.03720401 -10.3108526

Estimated Scale Parameter:  1
Number of Iterations:  1

Working Correlation
     [,1] [,2] [,3] [,4] [,5] [,6] [,7]
[1,]    1    0    0    0    0    0    0
[2,]    0    1    0    0    0    0    0
[3,]    0    0    1    0    0    0    0
[4,]    0    0    0    1    0    0    0
[5,]    0    0    0    0    1    0    0
[6,]    0    0    0    0    0    1    0
[7,]    0    0    0    0    0    0    1</code></pre>
</div>
</div>
</section>
<section id="random-intercept-model-1" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="random-intercept-model-1"><span class="header-section-number">5.3.2</span> Random Intercept Model</h3>
<p>The model is fitted to the data using the <code>glmer</code> function from the <code>lme4</code> package. This model allows for random intercepts for each subject, accounting for within-subject correlation. The outcome variable is modeled as a function of the treatment, time, and their interaction, with random intercepts for each patient. The model includes the following covariates:</p>
<ul>
<li><code>treatment</code></li>
<li><code>time</code> (a numerical variable representing the time points)</li>
<li><code>interaction between treatment and time</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>mod_toe1 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(outcome <span class="sc">~</span> treatment <span class="sc">*</span> time <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> patientID),</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> toenail,</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> binomial,</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">nAGQ =</span> <span class="dv">20</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<ul>
<li><code>outcome ~ treatment*time</code>: This specifies the fixed effects in the model, including the interaction between treatment and time.</li>
<li><code>(1 | patientID)</code>: This specifies the random intercept for each patient, allowing for individual variability.</li>
<li><code>data = toenail</code>: The dataset used for the analysis.</li>
<li><code>family = binomial</code>: Indicates that the outcome variable is binary.</li>
<li><code>nAGQ = 20</code>: The number of quadrature points for approximating the likelihood. Higher values lead to more accurate but computationally intensive results.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_toe1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Adaptive
  Gauss-Hermite Quadrature, nAGQ = 20) [glmerMod]
 Family: binomial  ( logit )
Formula: outcome ~ treatment * time + (1 | patientID)
   Data: toenail

     AIC      BIC   logLik deviance df.resid 
  1260.8   1288.5   -625.4   1250.8     1903 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.208 -0.194 -0.093 -0.009 43.658 

Random effects:
 Groups    Name        Variance Std.Dev.
 patientID (Intercept) 16.03    4.004   
Number of obs: 1908, groups:  patientID, 294

Fixed effects:
                          Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -1.61833    0.43329  -3.735 0.000188 ***
treatmentterbinafine      -0.16081    0.58379  -0.275 0.782968    
time                      -0.39084    0.04433  -8.817  &lt; 2e-16 ***
treatmentterbinafine:time -0.13672    0.06799  -2.011 0.044337 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) trtmnt time  
trtmnttrbnf -0.652              
time        -0.172  0.214       
trtmnttrbn:  0.199 -0.299 -0.570</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(mod_toe1, <span class="at">effect =</span> <span class="st">"fixed"</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">effect</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-1.6183291</td>
<td style="text-align: right;">0.4332876</td>
<td style="text-align: right;">-3.7349999</td>
<td style="text-align: right;">0.0001877</td>
<td style="text-align: right;">-2.4675571</td>
<td style="text-align: right;">-0.7691010</td>
</tr>
<tr class="even">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">treatmentterbinafine</td>
<td style="text-align: right;">-0.1608070</td>
<td style="text-align: right;">0.5837891</td>
<td style="text-align: right;">-0.2754539</td>
<td style="text-align: right;">0.7829675</td>
<td style="text-align: right;">-1.3050126</td>
<td style="text-align: right;">0.9833986</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">time</td>
<td style="text-align: right;">-0.3908424</td>
<td style="text-align: right;">0.0443270</td>
<td style="text-align: right;">-8.8172511</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-0.4777217</td>
<td style="text-align: right;">-0.3039630</td>
</tr>
<tr class="even">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">treatmentterbinafine:time</td>
<td style="text-align: right;">-0.1367248</td>
<td style="text-align: right;">0.0679920</td>
<td style="text-align: right;">-2.0108945</td>
<td style="text-align: right;">0.0443366</td>
<td style="text-align: right;">-0.2699867</td>
<td style="text-align: right;">-0.0034629</td>
</tr>
</tbody>
</table>


</div>
</div>
<hr>
<ul>
<li>This code uses the <code>broom.mixed</code> package to tidy up the model output and includes confidence intervals for the estimates.</li>
<li>The result shows the log-odds coefficients, standard errors, z-values, p-values, and confidence intervals for each fixed effect.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(mod_toe1, <span class="at">effect =</span> <span class="st">"fixed"</span>, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">effect</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.1982297</td>
<td style="text-align: right;">0.0858904</td>
<td style="text-align: right;">-3.7349999</td>
<td style="text-align: right;">0.0001877</td>
<td style="text-align: right;">0.0847917</td>
<td style="text-align: right;">0.4634295</td>
</tr>
<tr class="even">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">treatmentterbinafine</td>
<td style="text-align: right;">0.8514564</td>
<td style="text-align: right;">0.4970710</td>
<td style="text-align: right;">-0.2754539</td>
<td style="text-align: right;">0.7829675</td>
<td style="text-align: right;">0.2711691</td>
<td style="text-align: right;">2.6735271</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">time</td>
<td style="text-align: right;">0.6764868</td>
<td style="text-align: right;">0.0299866</td>
<td style="text-align: right;">-8.8172511</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.6201948</td>
<td style="text-align: right;">0.7378882</td>
</tr>
<tr class="even">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">treatmentterbinafine:time</td>
<td style="text-align: right;">0.8722102</td>
<td style="text-align: right;">0.0593033</td>
<td style="text-align: right;">-2.0108945</td>
<td style="text-align: right;">0.0443366</td>
<td style="text-align: right;">0.7633896</td>
<td style="text-align: right;">0.9965431</td>
</tr>
</tbody>
</table>


</div>
</div>
<hr>
<ul>
<li>This code converts the log-odds coefficients into odds ratios by exponentiating the coefficients.</li>
<li>Odds ratios are easier to interpret in the context of logistic regression.</li>
</ul>
<hr>
<p><strong>Summary of Output</strong></p>
<ul>
<li><p><strong>Intercept</strong>: The intercept represents the log-odds of the outcome for the reference group (baseline category) when all covariates are at their reference levels (e.g., no treatment and at the initial time point).</p></li>
<li><p><strong>Treatment Effect</strong>: The coefficient for treatment (<code>treatmentterbinafine</code>) represents the change in log-odds of the outcome associated with being in the treatment group versus the control group. An odds ratio less than 1 suggests a protective effect of the treatment, although in this case, the result is not statistically significant (p-value &gt; 0.05).</p></li>
<li><p><strong>Time Effect</strong>: The coefficient for time indicates how the log-odds of the outcome change over time. A negative coefficient suggests that the probability of the outcome decreases over time.</p></li>
<li><p><strong>Interaction Effect</strong>: The interaction term (<code>treatmentterbinafine:time</code>) shows how the effect of treatment changes over time. A significant interaction effect indicates that the treatment’s impact on the outcome varies depending on the time point.</p></li>
</ul>
</section>
<section id="interpretation-1" class="level3" data-number="5.3.3">
<h3 data-number="5.3.3" class="anchored" data-anchor-id="interpretation-1"><span class="header-section-number">5.3.3</span> Interpretation</h3>
<ol type="1">
<li><p><strong>Itraconazole Group</strong></p>
<ul>
<li>The estimated conditional odds for a subject in the itraconazole group are multiplied by 0.68 for every month.</li>
<li>Each month, the odds of having a none or mild toenail condition (versus moderate or severe) decrease by 32% for subjects in the itraconazole group.</li>
<li>This suggests that the treatment’s effectiveness improves over time.</li>
</ul></li>
</ol>
<p><span class="math display">\[
100\% \times (0.6765 - 1) = -32\%
\]</span></p>
<ol start="2" type="1">
<li><p><strong>Terbinafine Group</strong></p>
<ul>
<li>The conditional odds for a subject in the terbinafine group are multiplied by 0.59 for every month.</li>
<li>Each month, the odds of having a none or mild toenail condition decrease by 41% for subjects in the terbinafine group.</li>
<li>This larger reduction indicates that the effectiveness of terbinafine in improving toenail conditions is more pronounced over time compared to the itraconazole group.</li>
</ul></li>
</ol>
<p><span class="math display">\[
100\% \times (0.6765 \times 0.8722 - 1) = -41\%
\]</span></p>
</section>
<section id="prediction-1" class="level3" data-number="5.3.4">
<h3 data-number="5.3.4" class="anchored" data-anchor-id="prediction-1"><span class="header-section-number">5.3.4</span> Prediction</h3>
<p>Estimate the predicted probabilities and log-odds for each observation in the dataset using the fitted random intercept model.</p>
<section id="fixed-effects" class="level4" data-number="5.3.4.1">
<h4 data-number="5.3.4.1" class="anchored" data-anchor-id="fixed-effects"><span class="header-section-number">5.3.4.1</span> Fixed Effects</h4>
<p>Extracts the fixed effect coefficients from the model, which are used to calculate predictions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(mod_toe1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              (Intercept)      treatmentterbinafine                      time 
               -1.6183291                -0.1608070                -0.3908424 
treatmentterbinafine:time 
               -0.1367248 </code></pre>
</div>
</div>
</section>
<section id="random-effects" class="level4" data-number="5.3.4.2">
<h4 data-number="5.3.4.2" class="anchored" data-anchor-id="random-effects"><span class="header-section-number">5.3.4.2</span> Random Effects</h4>
<p>Extracts the random effect values for each patient. The random intercepts account for individual variability not explained by the fixed effects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>re_toe <span class="ot">&lt;-</span> <span class="fu">ranef</span>(mod_toe1)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(re_toe<span class="sc">$</span>patientID, <span class="dv">20</span>) <span class="sc">%&gt;%</span> <span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-05871bd874f80eb5a16e" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-05871bd874f80eb5a16e">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","6","7","9","10","11","12","13","15","16","17","18","19","20","21","22","23"],[3.734188811859859,1.933207342365403,0.9466443385845955,0.9541292665132447,3.251818688686432,3.365428422391077,-1.398883202046153,-1.603982297617279,4.359342542283486,2.727385517530374,3.575709724322962,2.299228827802934,1.245832845864917,3.708745044481535,1.074313946387475,-1.410957792472582,-1.497872573228743,2.875857966830648,2.835950098314993,-1.395463477005459]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>(Intercept)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":1},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"(Intercept)","targets":1}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="predicted-log-odds-and-probability" class="level4" data-number="5.3.4.3">
<h4 data-number="5.3.4.3" class="anchored" data-anchor-id="predicted-log-odds-and-probability"><span class="header-section-number">5.3.4.3</span> Predicted Log Odds and Probability</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">predict</span>(mod_toe1, <span class="at">type =</span> <span class="st">"link"</span>), <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          1           2           3           4           5           6 
 1.95505276  1.50285233  0.08972621 -0.43784094 -2.02054238 -3.33945813 
          7           8           9          10          11          12 
-4.94100427  0.31487827 -0.06200543 -0.46680645 -0.87160735 -2.22559706 
         13          14          15          16          17          18 
-3.20270296 -0.67168473 -1.16023768 -1.49524547 -1.94192240 -3.30987066 
         19          20 
-4.20322451 -5.16637186 </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>type = 'link'</code>: Returns the predicted log-odds.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">predict</span>(mod_toe1, <span class="at">type =</span> <span class="st">"response"</span>), <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          1           2           3           4           5           6 
0.875996549 0.817999505 0.522416516 0.392255551 0.117062920 0.034242072 
          7           8           9          10          11          12 
0.007096694 0.578075543 0.484503608 0.385372393 0.294919956 0.097475298 
         13          14          15          16          17          18 
0.039064132 0.338119704 0.238624100 0.183135715 0.125436813 0.035234116 
         19          20 
0.014727170 0.005672866 </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>type = 'response'</code>: Returns the predicted probabilities.</p>
</div>
</div>
</section>
<section id="manual-calculation-of-log-odds" class="level4" data-number="5.3.4.4">
<h4 data-number="5.3.4.4" class="anchored" data-anchor-id="manual-calculation-of-log-odds"><span class="header-section-number">5.3.4.4</span> Manual Calculation of Log Odds</h4>
<p>The log-odds for each observation can be manually calculated using the fixed and random effect coefficients. The logistic regression model is specified as follows:</p>
<p><span class="math display">\[
\text{Log Odds} = \beta_0 + \beta_1 \times \text{treatment} + \beta_2 \times \text{time} + \beta_3 \times (\text{treatment} \times \text{time}) + u_i
\]</span></p>
<ul>
<li>Intercept: -1.6183291</li>
<li>Treatment (terbinafine): -0.1608070</li>
<li>Time: -0.3908424</li>
<li>Interaction between treatment (terbinafine) and time: -0.1367248</li>
</ul>
<section id="observation-1" class="level5" data-number="5.3.4.4.1">
<h5 data-number="5.3.4.4.1" class="anchored" data-anchor-id="observation-1"><span class="header-section-number">5.3.4.4.1</span> Observation 1</h5>
<ul>
<li>Treatment (tx) = 1 (terbinafine)</li>
<li>Month = 0</li>
<li>Random effect (RE) for patient 1 = 3.7341888</li>
</ul>
<p><span class="math display">\[
\text{Log Odds} = -1.6183291 + (-0.1608070 \times 1) + (-0.3908424 \times 0) + (-0.1367248 \times (1 \times 0)) + 3.7341888
\]</span></p>
<p><span class="math display">\[
\text{Log Odds} = 1.955053
\]</span></p>
</section>
<section id="observation-7" class="level5" data-number="5.3.4.4.2">
<h5 data-number="5.3.4.4.2" class="anchored" data-anchor-id="observation-7"><span class="header-section-number">5.3.4.4.2</span> Observation 7</h5>
<ul>
<li>Treatment (tx) = 1 (terbinafine)</li>
<li>Month = 13.07143</li>
<li>Random effect (RE) for patient 1 = 3.7341888</li>
</ul>
<p><span class="math display">\[
\text{Log Odds} = -1.6183291 + (-0.1608070 \times 1) + (-0.3908424 \times 13.07143) + (-0.1367248 \times (1 \times 13.07143)) + 3.7341888
\]</span></p>
<p><span class="math display">\[
\text{Log Odds} = -4.941005
\]</span></p>
</section>
</section>
<section id="predicting-new-data" class="level4" data-number="5.3.4.5">
<h4 data-number="5.3.4.5" class="anchored" data-anchor-id="predicting-new-data"><span class="header-section-number">5.3.4.5</span> Predicting New Data</h4>
<ol type="1">
<li>Create new data:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new dataset with combinations of treatment and time values</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>new_data2 <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">c</span>(<span class="st">"itraconazole"</span>, <span class="st">"terbinafine"</span>),</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">18</span>, <span class="at">by =</span> <span class="dv">2</span>)</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Predict the probability:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate the probabilities and log-odds for new data</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>pred_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod_toe1,</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> new_data2,</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"response"</span>,</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">re.form =</span> <span class="sc">~</span><span class="dv">0</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>Visualize the predictions:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the data and the probability column</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>new_data3 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(new_data2, pred_prob)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(new_data3, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> pred_prob)) <span class="sc">+</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> treatment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Mixed-Effect-Models_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol start="4" type="1">
<li>Predict the log odds:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predict the log-odds for the new data without considering the random effects</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod_toe1,</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> new_data2,</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"link"</span>,</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">re.form =</span> <span class="sc">~</span><span class="dv">0</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         1          2          3          4          5          6          7 
 -2.009171  -2.306703  -2.790856  -3.361837  -3.572541  -4.416972  -4.354226 
         8          9         10         11         12         13         14 
 -5.472106  -5.135910  -6.527240  -5.917595  -7.582375  -6.699280  -8.637509 
        15         16         17         18 
 -7.480964  -9.692643  -8.262649 -10.747778 </code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="plots-2" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="plots-2"><span class="header-section-number">5.4</span> Plots</h2>
<section id="fixed-effect-plot-1" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="fixed-effect-plot-1"><span class="header-section-number">5.4.1</span> Fixed Effect Plot</h3>
<p>The fixed effect (also known as the regression coefficient) represents the overall impact of each predictor on the response variable, assuming all random effects are zero.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fixed effect (beta of the model)</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>mod_toe1<span class="sc">@</span>beta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.6183291 -0.1608070 -0.3908424 -0.1367248</code></pre>
</div>
</div>
<hr>
<ul>
<li>The intercept (<span class="math inline">\(\beta_0\)</span>): -1.6183291</li>
<li>The effect of the treatment (<span class="math inline">\(\beta_1\)</span>): -0.1608070</li>
<li>The effect of time (<span class="math inline">\(\beta_2\)</span>): -0.3908424</li>
<li>The interaction effect of treatment and time (<span class="math inline">\(\beta_3\)</span>): -0.1367248</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fixed effect plot</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(mod_toe1, <span class="at">type =</span> <span class="st">"est"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Mixed-Effect-Models_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="random-effect-plot-2" class="level3" data-number="5.4.2">
<h3 data-number="5.4.2" class="anchored" data-anchor-id="random-effect-plot-2"><span class="header-section-number">5.4.2</span> Random Effect Plot</h3>
<p>Random effect represents the deviation of individual groups (patients) from the overall model. It capture the variability in the data that is not explained by the fixed effects alone.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Random effect</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>mod_toe1<span class="sc">@</span>u <span class="sc">%&gt;%</span> <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-d57155844bde28c130ba" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d57155844bde28c130ba">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294"],[0.9326335394710922,0.482828827646708,0.2364294642280546,0.2382988648337796,0.812159032696949,0.8405336686357673,-0.3493785284470294,-0.4006031196721176,1.088769012446321,0.6811790557129468,0.8930525434935292,0.574244642616185,0.3111533870323071,0.9262788230860612,0.2683156285885497,-0.3523942217004876,-0.3741016509958475,0.7182608405078323,0.7082936378456924,-0.3485244339088553,-0.3310804311357679,-0.3947689291109974,0.9863912205119282,1.082823206909652,0.5054237489692243,-0.3169537071689685,1.046226360419251,-0.3481528621511061,0.4823030979627726,0.572303793294984,1.141338591860597,-0.3878554051051325,-0.3423791609026797,0.7647242526474773,-0.2414839461595653,-0.3302443170126832,0.5825176792482267,-0.3942530983099601,-0.3499879271747962,0.6882239084056707,1.081963281160905,0.8011417698709535,-0.3888238677337807,-0.347202005454494,-0.3993930388774579,1.113220046489901,-0.3737924858417598,-0.2609689620793985,-0.3460649341690416,-0.4064655261077403,-0.3977579233010035,-0.3509079733740686,0.3085679881162288,-0.3905756864934226,-0.3477302735557518,-0.3965837960166415,-0.3964799055415077,-0.3938078836462249,-0.347607219602183,-0.3529019515982758,-0.3522630929832797,-0.3986140512062792,0.4856076159697717,-0.3530128700744486,-0.3530128700744486,-0.4002261310490439,-0.3989117959512858,0.306767219050104,0.6796665329347322,-0.3533260458368389,-0.4046510021802462,1.000153128120348,-0.3558427247821268,-0.3558427247821268,-0.4014903435644496,-0.3499090310105714,-0.2609689620793985,-0.3968237536202162,0.4916196837332189,-0.3522630929832797,0.58060187000826,0.6901133090537163,-0.4006193105187113,-0.3535411036346265,0.3067332168440776,0.3042962289810673,-0.3519261731527878,0.6808101651740266,-0.4004202577207696,2.232794023714064,-0.349393470437861,0.5777289660930603,-0.3916872011872629,-0.4013209056157822,-0.3522630929832797,0.6796787683036764,-0.3977892474284435,0.8066359555215268,0.8212095016705749,0.8508288623907366,-0.3952081279568894,-0.3470518766155861,1.079746287716364,-0.3519930222192759,-0.3525854830971706,-0.4007854027964339,-0.3976449503851255,-0.3521909525321553,-0.3985276069178906,-0.3522727825036798,-0.400653074464502,-0.3500570199169594,-0.3896103158959031,-0.3570079197011197,0.2170104361900204,-0.355088196426165,-0.3337638430146836,-0.4005498705217216,0.8284088233827734,-0.4006111576894473,0.8095186583523856,-0.347665298754314,0.4766862074351774,0.8898390128027198,0.9349950667089172,-0.3507144340618992,1.056107809115649,1.089402895807636,-0.3465568424299397,0.6003377079556436,-0.3525299683934656,-0.3525299683934656,-0.4008674539290232,-0.4015053132976195,-0.4000435390003975,0.4764652387842981,-0.3519563404774351,-0.3521549242405257,0.8159072664112312,0.6926983168635861,0.9855358545940733,0.3054877456260912,-0.3574741965360266,1.783979565723979,1.791349136905849,0.6313101422138301,-0.3895495856040951,1.775186474161625,-0.3485125803610033,-0.3997281334706943,0.2254803069877208,-0.3450619982551518,0.8908669564350361,0.836575935769222,-0.3907163294705924,0.6853676470746842,-0.4014626140953727,-0.3525114034673204,-0.4019260859740578,-0.4019260859740578,1.049301392510501,0.2181279192282518,1.917680665856735,-0.347789520161818,-0.3476622939405309,-0.3968730871483485,1.798162038959118,0.2602383286084016,-0.3692537592738446,-0.3404284963760687,1.154934370234255,1.079326867443829,-0.397211696324058,-0.3480512180645892,-0.352161469861121,-0.3898467324468912,1.123543403925278,1.109024654390886,-0.3508263018176821,-0.3948254054115088,-0.3683991738970809,0.4887528037153715,-0.35088934060587,0.9707127916654057,-0.3454863603095448,-0.3612138195984989,1.822475139398242,-0.3965540434200044,-0.3526921173123016,1.058438521455784,-0.3491385796776607,1.305050827501559,1.936142955556599,0.8062603529601692,-0.4025220892896397,-0.4000425045649876,-0.334110665570028,0.2265252011021422,0.7792452438361734,0.3091718323977371,1.07873282081537,-0.3966740252627857,-0.4001840668429371,-0.3503556789959577,-0.4015484286563106,-0.3518923899711427,0.4868907546233815,-0.4005720578845615,-0.3995394047779594,0.735605587718865,-0.357144864878421,-0.3885144927096968,0.3034299560156696,0.8158893868323649,-0.3513799524927605,0.8946894356610826,-0.4016968590026551,-0.4010485365877434,-0.3595779297057647,0.3217948744223615,1.056309212274555,0.7182638295688542,1.744604595750341,-0.3426541338956039,1.216525499656095,-0.3438564140425526,1.071511843671144,0.7645827050959654,-0.3967257325137346,-0.4142310506500442,-0.3406407966181071,-0.3462104717900719,-0.3966431520806922,1.12219033161877,-0.3522585150699539,1.247329655954854,1.349670651445473,-0.3528967303988718,0.234362718716329,-0.3902503573577033,0.7111606381103468,0.2235419371488034,-0.334110665570028,0.8972232132053398,0.2219832879492592,-0.393793992587823,-0.3524638110462835,-0.3922929673110974,-0.3455761353211921,-0.3529922456998474,-0.3334582758005966,0.479989180762522,-0.3502537555724125,-0.4005696231958494,0.5860265295675375,-0.3518233042779187,0.8996827135340578,1.241693494126567,1.83628238746962,2.15067363669131,2.200528253541744,-0.3906055266578115,-0.35202100290129,-0.3632336035045207,0.5847268438484596,0.3014309083023262,-0.3485686338973685,0.8431835336115113,0.4916291516633646,-0.3491261758363248,0.6161947965638956,1.060529550684809,1.850511238202873,-0.3997011556821037,-0.348511064096454,0.3138373435590482,-0.3515604087699138,1.112709051622722,0.2267488210697333,-0.3547196879239549,-0.3527119779318278,-0.3892264494255303,-0.4060009059154758,-0.3978376236349456,-0.3482532618723254,-0.3475376571562802,-0.3993933139656539,0.4783585557151818,-0.3545738565455063,1.058232196167047,0.7647242526474773,0.7520545860405071,0.8143901772237748,1.130914965012399]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>x<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":1},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"x","targets":1}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The output provides the random effect estimates for each patient in the study, which show how each patient’s intercept deviates from the overall intercept.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Random effect plot</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(mod_toe1, <span class="at">type =</span> <span class="st">"re"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Mixed-Effect-Models_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="acknowledgment" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Acknowledgment</h1>
<p>I would like to express my gratitude to <a href="https://myanalytics.com.my/">Professor Dr.&nbsp;Kamarul Imran Musa</a>, Medical Epidemiologist and Statistician, and Professor in Epidemiology and Biostatistics at the School of Medical Sciences, Universiti Sains Malaysia, for his teaching and guidance on the subject matter.</p>
</section>
<section id="references" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> References</h1>
<ul>
<li>Lecture on Logistic Regression for Correlated Data by <a href="https://myanalytics.com.my/">Professor Dr.&nbsp;Kamarul Imran Musa</a></li>
<li>Applied Logistic Regression by Hosmer, D.W., Lemeshow, S., and Sturdivant, R.X. (2013). Applied Logistic Regression. Wiley</li>
<li>Multilevel Models for Binary Responses R Practicals: P7.5 Two-Level Random Slope Model by Camille Szmaragd and George Leckie from the Centre for Multilevel Modelling, Bristol University</li>
<li>Multilevel and Longitudinal Modelling Using Stata, Chapter 10 (pg. 515)</li>
</ul>
</section>
<section id="r-codes" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> R Codes</h1>
<p>The R codes used in this analysis are available at the following GitHub repository: <a href="https://github.com/drsaufi/DrPH-Epidemiology-Revision.git">DrPH-Epidemiology-Revision</a>. This repository includes all scripts and data necessary to replicate the analyses presented in this work.</p>
</section>

</main>
<!-- /main column -->
&nbsp;
<hr>

<p style="text-align: center;">A dedicated work by Dr Muhammad Saufi</p>



<!-- Add icon library -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">



<!-- Add font awesome icons -->

<p style="text-align: center;">

    <a href="https://www.facebook.com/drsaufimbbch/" class="fa fa-facebook"></a>

    <a href="https://github.com/drsaufi" class="fa fa-github"></a>

    <a href="mailto:drsaufimbbch@gmail.com" class="fa fa-envelope"></a>

</p>



&nbsp;
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>