<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Dr Muhammad Saufi">
<meta name="dcterms.date" content="2024-07-08">
<title>Machine Learning Regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="Machine Learning Regression_files/libs/clipboard/clipboard.min.js"></script>
<script src="Machine Learning Regression_files/libs/quarto-html/quarto.js"></script>
<script src="Machine Learning Regression_files/libs/quarto-html/popper.min.js"></script>
<script src="Machine Learning Regression_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Machine Learning Regression_files/libs/quarto-html/anchor.min.js"></script>
<link href="Machine Learning Regression_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Machine Learning Regression_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="Machine Learning Regression_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="Machine Learning Regression_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Machine Learning Regression_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Machine Learning Regression_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="Machine Learning Regression_files/libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><link rel="stylesheet" href="styles.css">
</head>
<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="1"><h2 id="toc-title">Contents</h2>
   
  <ul>
<li>
<a href="#linear-regression-analysis" id="toc-linear-regression-analysis" class="nav-link active" data-scroll-target="#linear-regression-analysis"><span class="header-section-number">1</span> Linear Regression Analysis</a>
  <ul>
<li><a href="#install-required-packages" id="toc-install-required-packages" class="nav-link" data-scroll-target="#install-required-packages"><span class="header-section-number">1.1</span> Install Required Packages</a></li>
  <li><a href="#load-the-dataset" id="toc-load-the-dataset" class="nav-link" data-scroll-target="#load-the-dataset"><span class="header-section-number">1.2</span> Load the Dataset</a></li>
  <li><a href="#examine-the-dataset" id="toc-examine-the-dataset" class="nav-link" data-scroll-target="#examine-the-dataset"><span class="header-section-number">1.3</span> Examine the Dataset</a></li>
  <li><a href="#split-the-data" id="toc-split-the-data" class="nav-link" data-scroll-target="#split-the-data"><span class="header-section-number">1.4</span> Split the Data</a></li>
  <li><a href="#build-the-linear-regression-model" id="toc-build-the-linear-regression-model" class="nav-link" data-scroll-target="#build-the-linear-regression-model"><span class="header-section-number">1.5</span> Build the Linear Regression Model</a></li>
  <li><a href="#summarize-the-model" id="toc-summarize-the-model" class="nav-link" data-scroll-target="#summarize-the-model"><span class="header-section-number">1.6</span> Summarize the Model</a></li>
  <li><a href="#evaluate-the-model" id="toc-evaluate-the-model" class="nav-link" data-scroll-target="#evaluate-the-model"><span class="header-section-number">1.7</span> Evaluate the Model</a></li>
  <li><a href="#interpretation-of-results" id="toc-interpretation-of-results" class="nav-link" data-scroll-target="#interpretation-of-results"><span class="header-section-number">1.8</span> Interpretation of Results</a></li>
  </ul>
</li>
  <li>
<a href="#decision-tree" id="toc-decision-tree" class="nav-link" data-scroll-target="#decision-tree"><span class="header-section-number">2</span> Decision Tree</a>
  <ul>
<li><a href="#install-and-load-required-packages" id="toc-install-and-load-required-packages" class="nav-link" data-scroll-target="#install-and-load-required-packages"><span class="header-section-number">2.1</span> Install and Load Required Packages</a></li>
  <li><a href="#load-the-dataset-1" id="toc-load-the-dataset-1" class="nav-link" data-scroll-target="#load-the-dataset-1"><span class="header-section-number">2.2</span> Load the Dataset</a></li>
  <li><a href="#examine-the-dataset-structure" id="toc-examine-the-dataset-structure" class="nav-link" data-scroll-target="#examine-the-dataset-structure"><span class="header-section-number">2.3</span> Examine the Dataset Structure</a></li>
  <li><a href="#split-the-dataset" id="toc-split-the-dataset" class="nav-link" data-scroll-target="#split-the-dataset"><span class="header-section-number">2.4</span> Split the Dataset</a></li>
  <li><a href="#build-the-regression-tree" id="toc-build-the-regression-tree" class="nav-link" data-scroll-target="#build-the-regression-tree"><span class="header-section-number">2.5</span> Build the Regression Tree</a></li>
  <li><a href="#plot-the-decision-tree" id="toc-plot-the-decision-tree" class="nav-link" data-scroll-target="#plot-the-decision-tree"><span class="header-section-number">2.6</span> Plot the Decision Tree</a></li>
  <li><a href="#evaluate-the-tree" id="toc-evaluate-the-tree" class="nav-link" data-scroll-target="#evaluate-the-tree"><span class="header-section-number">2.7</span> Evaluate the Tree</a></li>
  <li>
<a href="#prune-the-tree" id="toc-prune-the-tree" class="nav-link" data-scroll-target="#prune-the-tree"><span class="header-section-number">2.8</span> Prune the Tree</a>
  <ul>
<li><a href="#pre-pruning" id="toc-pre-pruning" class="nav-link" data-scroll-target="#pre-pruning"><span class="header-section-number">2.8.1</span> Pre-pruning</a></li>
  <li><a href="#post-pruning" id="toc-post-pruning" class="nav-link" data-scroll-target="#post-pruning"><span class="header-section-number">2.8.2</span> Post-pruning</a></li>
  </ul>
</li>
  <li><a href="#export-the-tree" id="toc-export-the-tree" class="nav-link" data-scroll-target="#export-the-tree"><span class="header-section-number">2.9</span> Export the Tree</a></li>
  </ul>
</li>
  <li>
<a href="#neural-network_regression" id="toc-neural-network_regression" class="nav-link" data-scroll-target="#neural-network_regression"><span class="header-section-number">3</span> Neural Network_Regression</a>
  <ul>
<li><a href="#install-and-load-required-packages-1" id="toc-install-and-load-required-packages-1" class="nav-link" data-scroll-target="#install-and-load-required-packages-1"><span class="header-section-number">3.1</span> Install and Load Required Packages</a></li>
  <li><a href="#initialize-h2o" id="toc-initialize-h2o" class="nav-link" data-scroll-target="#initialize-h2o"><span class="header-section-number">3.2</span> Initialize H2O</a></li>
  <li><a href="#load-the-dataset-2" id="toc-load-the-dataset-2" class="nav-link" data-scroll-target="#load-the-dataset-2"><span class="header-section-number">3.3</span> Load the Dataset</a></li>
  <li><a href="#examine-the-data" id="toc-examine-the-data" class="nav-link" data-scroll-target="#examine-the-data"><span class="header-section-number">3.4</span> Examine the Data</a></li>
  <li><a href="#normalize-the-data" id="toc-normalize-the-data" class="nav-link" data-scroll-target="#normalize-the-data"><span class="header-section-number">3.5</span> Normalize the Data</a></li>
  <li><a href="#split-the-data-into-training-and-test-sets" id="toc-split-the-data-into-training-and-test-sets" class="nav-link" data-scroll-target="#split-the-data-into-training-and-test-sets"><span class="header-section-number">3.6</span> Split the Data into Training and Test Sets</a></li>
  <li><a href="#build-the-neural-network-model" id="toc-build-the-neural-network-model" class="nav-link" data-scroll-target="#build-the-neural-network-model"><span class="header-section-number">3.7</span> Build the Neural Network Model</a></li>
  <li><a href="#plot-the-scoring-history" id="toc-plot-the-scoring-history" class="nav-link" data-scroll-target="#plot-the-scoring-history"><span class="header-section-number">3.8</span> Plot the Scoring History</a></li>
  <li><a href="#make-predictions-and-evaluate-the-model" id="toc-make-predictions-and-evaluate-the-model" class="nav-link" data-scroll-target="#make-predictions-and-evaluate-the-model"><span class="header-section-number">3.9</span> Make Predictions and Evaluate the Model</a></li>
  <li><a href="#implement-early-stopping" id="toc-implement-early-stopping" class="nav-link" data-scroll-target="#implement-early-stopping"><span class="header-section-number">3.10</span> Implement Early Stopping</a></li>
  <li><a href="#implement-dropout-regularization" id="toc-implement-dropout-regularization" class="nav-link" data-scroll-target="#implement-dropout-regularization"><span class="header-section-number">3.11</span> Implement Dropout Regularization</a></li>
  </ul>
</li>
  </ul></nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Machine Learning Regression</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dr Muhammad Saufi </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 8, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header><section id="linear-regression-analysis" class="level1" data-number="1"><h1 data-number="1">
<span class="header-section-number">1</span> Linear Regression Analysis</h1>
<p>To build and evaluate a linear regression model to predict the progression of diabetes using various attributes from the dataset.</p>
<section id="install-required-packages" class="level2" data-number="1.1"><h2 data-number="1.1" class="anchored" data-anchor-id="install-required-packages">
<span class="header-section-number">1.1</span> Install Required Packages</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mfrasco/Metrics">Metrics</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'Metrics' was built under R version 4.4.1</code></pre>
</div>
</div>
</section><section id="load-the-dataset" class="level2" data-number="1.2"><h2 data-number="1.2" class="anchored" data-anchor-id="load-the-dataset">
<span class="header-section-number">1.2</span> Load the Dataset</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">diabetes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"Datasets/diabetes.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="examine-the-dataset" class="level2" data-number="1.3"><h2 data-number="1.3" class="anchored" data-anchor-id="examine-the-dataset">
<span class="header-section-number">1.3</span> Examine the Dataset</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">diabetes</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   442 obs. of  11 variables:
 $ age     : num  0.03808 -0.00188 0.0853 -0.08906 0.00538 ...
 $ sex     : num  0.0507 -0.0446 0.0507 -0.0446 -0.0446 ...
 $ bmi     : num  0.0617 -0.0515 0.0445 -0.0116 -0.0364 ...
 $ bp      : num  0.02187 -0.02633 -0.00567 -0.03666 0.02187 ...
 $ s1      : num  -0.04422 -0.00845 -0.0456 0.01219 0.00393 ...
 $ s2      : num  -0.0348 -0.0192 -0.0342 0.025 0.0156 ...
 $ s3      : num  -0.0434 0.07441 -0.03236 -0.03604 0.00814 ...
 $ s4      : num  -0.00259 -0.03949 -0.00259 0.03431 -0.00259 ...
 $ s5      : num  0.01991 -0.06833 0.00286 0.02269 -0.03199 ...
 $ s6      : num  -0.01765 -0.0922 -0.02593 -0.00936 -0.04664 ...
 $ diabetes: num  151 75 141 206 135 97 138 63 110 310 ...</code></pre>
</div>
</div>
</section><section id="split-the-data" class="level2" data-number="1.4"><h2 data-number="1.4" class="anchored" data-anchor-id="split-the-data">
<span class="header-section-number">1.4</span> Split the Data</h2>
<p>Split the data into training and testing sets with a ratio of 70:30:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sample_ind1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">diabetes</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">diabetes</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="va">train1</span> <span class="op">&lt;-</span> <span class="va">diabetes</span><span class="op">[</span><span class="va">sample_ind1</span>, <span class="op">]</span></span>
<span><span class="va">test1</span> <span class="op">&lt;-</span> <span class="va">diabetes</span><span class="op">[</span><span class="op">-</span><span class="va">sample_ind1</span>, <span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="build-the-linear-regression-model" class="level2" data-number="1.5"><h2 data-number="1.5" class="anchored" data-anchor-id="build-the-linear-regression-model">
<span class="header-section-number">1.5</span> Build the Linear Regression Model</h2>
<p>Create the linear regression model using the training set:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lr.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">diabetes</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="summarize-the-model" class="level2" data-number="1.6"><h2 data-number="1.6" class="anchored" data-anchor-id="summarize-the-model">
<span class="header-section-number">1.6</span> Summarize the Model</h2>
<p>Display the summary of the model to understand the coefficients and residuals:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lr.mod</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = diabetes ~ ., data = train1)

Residuals:
     Min       1Q   Median       3Q      Max 
-139.901  -41.355   -1.631   39.170  146.020 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  152.44904    3.13631  48.608  &lt; 2e-16 ***
age          -15.57697   74.79887  -0.208  0.83517    
sex         -212.91860   75.02052  -2.838  0.00485 ** 
bmi          588.64386   83.56801   7.044 1.30e-11 ***
bp           218.09127   82.23542   2.652  0.00843 ** 
s1          -912.80361  485.98295  -1.878  0.06132 .  
s2           602.22823  396.07268   1.520  0.12945    
s3           136.25634  249.00911   0.547  0.58465    
s4           123.68058  187.39997   0.660  0.50978    
s5           901.55715  208.75437   4.319 2.14e-05 ***
s6             0.06945   80.30125   0.001  0.99931    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 54.78 on 298 degrees of freedom
Multiple R-squared:  0.5312,    Adjusted R-squared:  0.5154 
F-statistic: 33.76 on 10 and 298 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section><section id="evaluate-the-model" class="level2" data-number="1.7"><h2 data-number="1.7" class="anchored" data-anchor-id="evaluate-the-model">
<span class="header-section-number">1.7</span> Evaluate the Model</h2>
<p>Perform predictions on the test set and evaluate the model’s performance using RMSE (Root Mean Squared Error):</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">test1</span><span class="op">$</span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">lr.mod</span>, newdata <span class="op">=</span> <span class="va">test1</span><span class="op">)</span></span>
<span><span class="va">rmse_value1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span><span class="va">test1</span><span class="op">$</span><span class="va">diabetes</span>, <span class="va">test1</span><span class="op">$</span><span class="va">pred</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">rmse_value1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 53.93175</code></pre>
</div>
</div>
</section><section id="interpretation-of-results" class="level2" data-number="1.8"><h2 data-number="1.8" class="anchored" data-anchor-id="interpretation-of-results">
<span class="header-section-number">1.8</span> Interpretation of Results</h2>
<ul>
<li>
<strong>Coefficients:</strong> The “Estimate” column in the summary output lists the coefficients (slopes) for each attribute, which indicates the relationship between the predictor and the outcome variable.</li>
<li>
<strong>Residuals:</strong> The residuals indicate how well the model fits the data, represented by the vertical distances between the actual data points and the regression line.</li>
<li>
<strong>RMSE:</strong> The root mean squared error (RMSE) measures the average deviation of predictions from the actual values. A lower RMSE indicates a better fit of the model.</li>
</ul></section></section><section id="decision-tree" class="level1" data-number="2"><h1 data-number="2">
<span class="header-section-number">2</span> Decision Tree</h1>
<section id="install-and-load-required-packages" class="level2" data-number="2.1"><h2 data-number="2.1" class="anchored" data-anchor-id="install-and-load-required-packages">
<span class="header-section-number">2.1</span> Install and Load Required Packages</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bethatkinson/rpart">rpart</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mfrasco/Metrics">Metrics</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="load-the-dataset-1" class="level2" data-number="2.2"><h2 data-number="2.2" class="anchored" data-anchor-id="load-the-dataset-1">
<span class="header-section-number">2.2</span> Load the Dataset</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">diabetes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"Datasets/diabetes.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="examine-the-dataset-structure" class="level2" data-number="2.3"><h2 data-number="2.3" class="anchored" data-anchor-id="examine-the-dataset-structure">
<span class="header-section-number">2.3</span> Examine the Dataset Structure</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">diabetes</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   442 obs. of  11 variables:
 $ age     : num  0.03808 -0.00188 0.0853 -0.08906 0.00538 ...
 $ sex     : num  0.0507 -0.0446 0.0507 -0.0446 -0.0446 ...
 $ bmi     : num  0.0617 -0.0515 0.0445 -0.0116 -0.0364 ...
 $ bp      : num  0.02187 -0.02633 -0.00567 -0.03666 0.02187 ...
 $ s1      : num  -0.04422 -0.00845 -0.0456 0.01219 0.00393 ...
 $ s2      : num  -0.0348 -0.0192 -0.0342 0.025 0.0156 ...
 $ s3      : num  -0.0434 0.07441 -0.03236 -0.03604 0.00814 ...
 $ s4      : num  -0.00259 -0.03949 -0.00259 0.03431 -0.00259 ...
 $ s5      : num  0.01991 -0.06833 0.00286 0.02269 -0.03199 ...
 $ s6      : num  -0.01765 -0.0922 -0.02593 -0.00936 -0.04664 ...
 $ diabetes: num  151 75 141 206 135 97 138 63 110 310 ...</code></pre>
</div>
</div>
</section><section id="split-the-dataset" class="level2" data-number="2.4"><h2 data-number="2.4" class="anchored" data-anchor-id="split-the-dataset">
<span class="header-section-number">2.4</span> Split the Dataset</h2>
<p>Split the dataset into training (70%) and test (30%) sets. The training set is used for training and creating the model. The test set is to evaluate the accuracy of the model.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sample_ind2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">diabetes</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">diabetes</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="va">train2</span> <span class="op">&lt;-</span> <span class="va">diabetes</span><span class="op">[</span><span class="va">sample_ind2</span>, <span class="op">]</span></span>
<span><span class="va">test2</span> <span class="op">&lt;-</span> <span class="va">diabetes</span><span class="op">[</span><span class="op">-</span><span class="va">sample_ind2</span>, <span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="build-the-regression-tree" class="level2" data-number="2.5"><h2 data-number="2.5" class="anchored" data-anchor-id="build-the-regression-tree">
<span class="header-section-number">2.5</span> Build the Regression Tree</h2>
<p>Build a regression tree using the <code>rpart</code> function:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">reg_tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.html">rpart</a></span><span class="op">(</span><span class="va">diabetes</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train2</span>, method <span class="op">=</span> <span class="st">"anova"</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.control.html">rpart.control</a></span><span class="op">(</span>cp <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="plot-the-decision-tree" class="level2" data-number="2.6"><h2 data-number="2.6" class="anchored" data-anchor-id="plot-the-decision-tree">
<span class="header-section-number">2.6</span> Plot the Decision Tree</h2>
<p>Plot and visualize the decision tree:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">reg_tree</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="va">reg_tree</span>, cex <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Machine-Learning-Regression_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="evaluate-the-tree" class="level2" data-number="2.7"><h2 data-number="2.7" class="anchored" data-anchor-id="evaluate-the-tree">
<span class="header-section-number">2.7</span> Evaluate the Tree</h2>
<p>Evaluate the tree using the test set and calculate the root mean squared error (RMSE):</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">test2</span><span class="op">$</span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">reg_tree</span>, <span class="va">test2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span><span class="va">test2</span><span class="op">$</span><span class="va">diabetes</span>, <span class="va">test2</span><span class="op">$</span><span class="va">pred</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 68.61328</code></pre>
</div>
</div>
</section><section id="prune-the-tree" class="level2" data-number="2.8"><h2 data-number="2.8" class="anchored" data-anchor-id="prune-the-tree">
<span class="header-section-number">2.8</span> Prune the Tree</h2>
<section id="pre-pruning" class="level3" data-number="2.8.1"><h3 data-number="2.8.1" class="anchored" data-anchor-id="pre-pruning">
<span class="header-section-number">2.8.1</span> Pre-pruning</h3>
<p>Perform pre-pruning by specifying parameters like <code>maxdepth</code>, <code>minsplit</code>, and <code>minbucket</code>:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">reg_tree_es</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.html">rpart</a></span><span class="op">(</span><span class="va">diabetes</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train2</span>, method <span class="op">=</span> <span class="st">"anova"</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.control.html">rpart.control</a></span><span class="op">(</span>cp <span class="op">=</span> <span class="fl">0</span>, maxdepth <span class="op">=</span> <span class="fl">6</span>, minsplit <span class="op">=</span> <span class="fl">70</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">test2</span><span class="op">$</span><span class="va">pred2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">reg_tree_es</span>, <span class="va">test2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span><span class="va">test2</span><span class="op">$</span><span class="va">diabetes</span>, <span class="va">test2</span><span class="op">$</span><span class="va">pred2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 59.39114</code></pre>
</div>
</div>
</section><section id="post-pruning" class="level3" data-number="2.8.2"><h3 data-number="2.8.2" class="anchored" data-anchor-id="post-pruning">
<span class="header-section-number">2.8.2</span> Post-pruning</h3>
<p>Perform post-pruning based on the cost complexity parameter (cp):</p>
<ol type="1">
<li>Display the cp table:</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/rpart/man/printcp.html">printcp</a></span><span class="op">(</span><span class="va">reg_tree</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Regression tree:
rpart(formula = diabetes ~ ., data = train2, method = "anova", 
    control = rpart.control(cp = 0))

Variables actually used in tree construction:
 [1] age bmi bp  s1  s2  s3  s4  s5  s6  sex

Root node error: 1776387/309 = 5748.8

n= 309 

          CP nsplit rel error  xerror     xstd
1  0.2794866      0   1.00000 1.00993 0.061746
2  0.1033478      1   0.72051 0.80888 0.057584
3  0.0506982      2   0.61717 0.72940 0.056425
4  0.0296834      3   0.56647 0.66557 0.051076
5  0.0275351      4   0.53678 0.67707 0.052823
6  0.0202890      5   0.50925 0.67891 0.052809
7  0.0191317      6   0.48896 0.66392 0.051870
8  0.0168215      7   0.46983 0.65904 0.051875
9  0.0165936      9   0.43619 0.65912 0.054532
10 0.0142398     10   0.41959 0.66039 0.054575
11 0.0118790     11   0.40535 0.64928 0.054539
12 0.0101360     12   0.39347 0.65917 0.054879
13 0.0075380     14   0.37320 0.64843 0.052819
14 0.0064456     15   0.36566 0.64715 0.051890
15 0.0058058     17   0.35277 0.65235 0.050371
16 0.0057446     18   0.34697 0.66358 0.050491
17 0.0056112     19   0.34122 0.66511 0.051137
18 0.0052524     20   0.33561 0.67190 0.051576
19 0.0041069     21   0.33036 0.67786 0.051616
20 0.0038584     23   0.32214 0.68940 0.052154
21 0.0036522     24   0.31829 0.68940 0.052154
22 0.0028755     25   0.31463 0.69839 0.052086
23 0.0012217     26   0.31176 0.70696 0.052295
24 0.0000000     27   0.31054 0.70427 0.051950</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Plot the cp values against the cross-validated error:</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/rpart/man/plotcp.html">plotcp</a></span><span class="op">(</span><span class="va">reg_tree</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Machine-Learning-Regression_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol start="3" type="1">
<li>Find the best cp value that minimizes the cross-validated error:</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bestcp</span> <span class="op">&lt;-</span> <span class="va">reg_tree</span><span class="op">$</span><span class="va">cptable</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span><span class="op">(</span><span class="va">reg_tree</span><span class="op">$</span><span class="va">cptable</span><span class="op">[</span>,<span class="st">"xerror"</span><span class="op">]</span><span class="op">)</span>,<span class="st">"CP"</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="4" type="1">
<li>Build the pruned tree and evaluate it:</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">reg_tree_prune</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.html">rpart</a></span><span class="op">(</span><span class="va">diabetes</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train2</span>, method <span class="op">=</span> <span class="st">"anova"</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.control.html">rpart.control</a></span><span class="op">(</span>cp <span class="op">=</span> <span class="va">bestcp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">test2</span><span class="op">$</span><span class="va">pred3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">reg_tree_prune</span>, <span class="va">test2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span><span class="va">test2</span><span class="op">$</span><span class="va">diabetes</span>, <span class="va">test2</span><span class="op">$</span><span class="va">pred3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 65.80663</code></pre>
</div>
</div>
</section></section><section id="export-the-tree" class="level2" data-number="2.9"><h2 data-number="2.9" class="anchored" data-anchor-id="export-the-tree">
<span class="header-section-number">2.9</span> Export the Tree</h2>
<p>Create a postscript file of the tree for generating a PDF:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/rpart/man/post.rpart.html">post</a></span><span class="op">(</span><span class="va">reg_tree_prune</span>, file <span class="op">=</span> <span class="st">"reg_tree_prune.ps"</span>, title <span class="op">=</span> <span class="st">"Regression Tree for Diabetes Dataset"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="neural-network_regression" class="level1" data-number="3"><h1 data-number="3">
<span class="header-section-number">3</span> Neural Network_Regression</h1>
<section id="install-and-load-required-packages-1" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="install-and-load-required-packages-1">
<span class="header-section-number">3.1</span> Install and Load Required Packages</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/h2oai/h2o-3">h2o</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>
----------------------------------------------------------------------

Your next step is to start H2O:
    &gt; h2o.init()

For H2O package documentation, ask for help:
    &gt; ??h2o

After starting H2O, you can use the Web UI at http://localhost:54321
For more information visit https://docs.h2o.ai

----------------------------------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'h2o'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    cor, sd, var</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    %*%, %in%, &amp;&amp;, ||, apply, as.factor, as.numeric, colnames,
    colnames&lt;-, ifelse, is.character, is.factor, is.numeric, log,
    log10, log1p, log2, round, signif, trunc</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mfrasco/Metrics">Metrics</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="initialize-h2o" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="initialize-h2o">
<span class="header-section-number">3.2</span> Initialize H2O</h2>
<p>Before building the model, initialize the H2O instance:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.init.html">h2o.init</a></span><span class="op">(</span>nthreads<span class="op">=</span><span class="op">-</span><span class="fl">1</span>, max_mem_size<span class="op">=</span><span class="st">"2G"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> Connection successful!

R is connected to the H2O cluster: 
    H2O cluster uptime:         13 minutes 23 seconds 
    H2O cluster timezone:       Asia/Singapore 
    H2O data parsing timezone:  UTC 
    H2O cluster version:        3.44.0.3 
    H2O cluster version age:    6 months and 18 days 
    H2O cluster name:           H2O_started_from_R_drsau_rjb539 
    H2O cluster total nodes:    1 
    H2O cluster total memory:   1.76 GB 
    H2O cluster total cores:    8 
    H2O cluster allowed cores:  8 
    H2O cluster healthy:        TRUE 
    H2O Connection ip:          localhost 
    H2O Connection port:        54321 
    H2O Connection proxy:       NA 
    H2O Internal Security:      FALSE 
    R Version:                  R version 4.4.0 (2024-04-24 ucrt) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in h2o.clusterInfo(): 
Your H2O cluster version is (6 months and 18 days) old. There may be a newer version available.
Please download and install the latest version from: https://h2o-release.s3.amazonaws.com/h2o/latest_stable.html</code></pre>
</div>
</div>
</section><section id="load-the-dataset-2" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="load-the-dataset-2">
<span class="header-section-number">3.3</span> Load the Dataset</h2>
<p>Load the dataset into R and convert it to an H2O frame:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">consultation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"Datasets/consultation_fee.csv"</span><span class="op">)</span></span>
<span><span class="va">consultation.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/as.h2o.html">as.h2o</a></span><span class="op">(</span><span class="va">consultation</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
</div>
</section><section id="examine-the-data" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="examine-the-data">
<span class="header-section-number">3.4</span> Examine the Data</h2>
<p>Check the structure of the data:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">consultation.frame</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Class 'H2OFrame' &lt;environment: 0x000002492dbaa180&gt; 
 - attr(*, "op")= chr "Parse"
 - attr(*, "id")= chr "consultation_sid_af8b_1"
 - attr(*, "eval")= logi FALSE
 - attr(*, "nrow")= int 5962
 - attr(*, "ncol")= int 6
 - attr(*, "types")=List of 6
  ..$ : chr "string"
  ..$ : chr "real"
  ..$ : chr "int"
  ..$ : chr "string"
  ..$ : chr "string"
  ..$ : chr "real"
 - attr(*, "data")='data.frame':    10 obs. of  6 variables:
  ..$ Qualification: chr  "BHMS, MD - Homeopathy" "BAMS, MD - Ayurveda Medicine" "MBBS, MS - Otorhinolaryngology" "BSc - Zoology, BAMS" ...
  ..$ Experience   : num  24 12 9 12 20 8 42 10 14 23
  ..$ Rating       : num  100 98 95 95 100 95 95 99 95 95
  ..$ Place        : chr  "Kakkanad, Ernakulam" "Whitefield, Bangalore" "Mathikere - BEL, Bangalore" "Bannerghatta Road, Bangalore" ...
  ..$ Profile      : chr  "Homeopath" "Ayurveda" "ENT Specialist" "Ayurveda" ...
  ..$ Fees         : num  100 350 300 250 250 100 200 200 100 100</code></pre>
</div>
</div>
</section><section id="normalize-the-data" class="level2" data-number="3.5"><h2 data-number="3.5" class="anchored" data-anchor-id="normalize-the-data">
<span class="header-section-number">3.5</span> Normalize the Data</h2>
<p>Normalize the columns “Experience”, “Rating”, and “Fees” as they are in different ranges:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">normalize</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span> <span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">consultation.frame</span><span class="op">$</span><span class="va">Experience.norm</span> <span class="op">&lt;-</span> <span class="fu">normalize</span><span class="op">(</span><span class="va">consultation.frame</span><span class="op">$</span><span class="va">Experience</span><span class="op">)</span></span>
<span><span class="va">consultation.frame</span><span class="op">$</span><span class="va">Rating.norm</span> <span class="op">&lt;-</span> <span class="fu">normalize</span><span class="op">(</span><span class="va">consultation.frame</span><span class="op">$</span><span class="va">Rating</span><span class="op">)</span></span>
<span><span class="va">consultation.frame</span><span class="op">$</span><span class="va">Fees.norm</span> <span class="op">&lt;-</span> <span class="fu">normalize</span><span class="op">(</span><span class="va">consultation.frame</span><span class="op">$</span><span class="va">Fees</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="split-the-data-into-training-and-test-sets" class="level2" data-number="3.6"><h2 data-number="3.6" class="anchored" data-anchor-id="split-the-data-into-training-and-test-sets">
<span class="header-section-number">3.6</span> Split the Data into Training and Test Sets</h2>
<p>Split the data into training (70%) and test (30%) sets:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.splitFrame.html">h2o.splitFrame</a></span><span class="op">(</span><span class="va">consultation.frame</span>, ratios <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="va">train3</span> <span class="op">&lt;-</span> <span class="va">split</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">test3</span> <span class="op">&lt;-</span> <span class="va">split</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="build-the-neural-network-model" class="level2" data-number="3.7"><h2 data-number="3.7" class="anchored" data-anchor-id="build-the-neural-network-model">
<span class="header-section-number">3.7</span> Build the Neural Network Model</h2>
<p>Build the neural network model with default parameters:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">8</span><span class="op">)</span>, </span>
<span>  y <span class="op">=</span> <span class="fl">9</span>, </span>
<span>  training_frame <span class="op">=</span> <span class="va">train3</span>, </span>
<span>  epochs <span class="op">=</span> <span class="fl">500</span>, </span>
<span>  mini_batch_size <span class="op">=</span> <span class="fl">32</span>, </span>
<span>  hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">20</span><span class="op">)</span>, </span>
<span>  seed <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in .h2o.processResponseWarnings(res): Dropping bad and constant columns: [Qualification, Place, Profile].</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
</div>
</section><section id="plot-the-scoring-history" class="level2" data-number="3.8"><h2 data-number="3.8" class="anchored" data-anchor-id="plot-the-scoring-history">
<span class="header-section-number">3.8</span> Plot the Scoring History</h2>
<p>Visualize the scoring history of the model:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">nn</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Machine-Learning-Regression_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="make-predictions-and-evaluate-the-model" class="level2" data-number="3.9"><h2 data-number="3.9" class="anchored" data-anchor-id="make-predictions-and-evaluate-the-model">
<span class="header-section-number">3.9</span> Make Predictions and Evaluate the Model</h2>
<p>Perform predictions on the test data and evaluate the model’s performance using RMSE:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pred1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.predict.html">h2o.predict</a></span><span class="op">(</span><span class="va">nn</span>, <span class="va">test3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span><span class="va">test3</span><span class="op">$</span><span class="va">Fees.norm</span>, <span class="va">pred1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2005547</code></pre>
</div>
</div>
</section><section id="implement-early-stopping" class="level2" data-number="3.10"><h2 data-number="3.10" class="anchored" data-anchor-id="implement-early-stopping">
<span class="header-section-number">3.10</span> Implement Early Stopping</h2>
<p>Add early stopping parameters to the model:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">8</span><span class="op">)</span>, </span>
<span>  y <span class="op">=</span> <span class="fl">9</span>, </span>
<span>  training_frame <span class="op">=</span> <span class="va">train3</span>, </span>
<span>  epochs <span class="op">=</span> <span class="fl">500</span>, </span>
<span>  mini_batch_size <span class="op">=</span> <span class="fl">32</span>, </span>
<span>  hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">20</span><span class="op">)</span>, </span>
<span>  seed <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  stopping_metric <span class="op">=</span> <span class="st">"rmse"</span>, </span>
<span>  stopping_rounds <span class="op">=</span> <span class="fl">3</span>, </span>
<span>  stopping_tolerance <span class="op">=</span> <span class="fl">0.05</span>, </span>
<span>  score_interval <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in .h2o.processResponseWarnings(res): Dropping bad and constant columns: [Qualification, Place, Profile].</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pred2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.predict.html">h2o.predict</a></span><span class="op">(</span><span class="va">nn</span>, <span class="va">test3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span><span class="va">test3</span><span class="op">$</span><span class="va">Fees.norm</span>, <span class="va">pred2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1987144</code></pre>
</div>
</div>
</section><section id="implement-dropout-regularization" class="level2" data-number="3.11"><h2 data-number="3.11" class="anchored" data-anchor-id="implement-dropout-regularization">
<span class="header-section-number">3.11</span> Implement Dropout Regularization</h2>
<p>Add dropout regularization to improve generalization:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">8</span><span class="op">)</span>, </span>
<span>  y <span class="op">=</span> <span class="fl">9</span>, </span>
<span>  training_frame <span class="op">=</span> <span class="va">train3</span>, </span>
<span>  epochs <span class="op">=</span> <span class="fl">500</span>, </span>
<span>  mini_batch_size <span class="op">=</span> <span class="fl">32</span>, </span>
<span>  hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">20</span><span class="op">)</span>, </span>
<span>  seed <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  stopping_metric <span class="op">=</span> <span class="st">"rmse"</span>, </span>
<span>  stopping_rounds <span class="op">=</span> <span class="fl">3</span>, </span>
<span>  stopping_tolerance <span class="op">=</span> <span class="fl">0.05</span>, </span>
<span>  score_interval <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  activation <span class="op">=</span> <span class="st">"RectifierWithDropout"</span>, </span>
<span>  hidden_dropout_ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>, </span>
<span>  input_dropout_ratio <span class="op">=</span> <span class="fl">0.1</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in .h2o.processResponseWarnings(res): Dropping bad and constant columns: [Qualification, Place, Profile].</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |====================================================                  |  74%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pred3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.predict.html">h2o.predict</a></span><span class="op">(</span><span class="va">nn</span>, <span class="va">test3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span><span class="va">test3</span><span class="op">$</span><span class="va">Fees.norm</span>, <span class="va">pred3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2004876</code></pre>
</div>
</div>
</section></section></main><!-- /main column -->
&nbsp;
<hr>
<p style="text-align: center;">A dedicated work by Dr Muhammad Saufi</p>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<!-- Add font awesome icons --><p style="text-align: center;">
    <a href="https://www.facebook.com/drsaufimbbch/" class="fa fa-facebook"></a>
    <a href="https://github.com/drsaufi" class="fa fa-github"></a>
    <a href="mailto:drsaufimbbch@gmail.com" class="fa fa-envelope"></a>
</p>

&nbsp;
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>